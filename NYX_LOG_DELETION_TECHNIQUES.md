# üóëÔ∏è NYX Cloud Scanner Module AWS - Log Deletion Techniques

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- **12 —Ç–µ—Ö–Ω–∏–∫ —ç—Å–∫–∞–ª–∞—Ü–∏–∏** (10 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö + 1 –≤—ã—Å–æ–∫–∞—è + 1 —Å—Ä–µ–¥–Ω—è—è)
- **67 –æ–ø–µ—Ä–∞—Ü–∏–π –ø—Ä–æ–≤–µ—Ä–∫–∏** –≤–∫–ª—é—á–∞—è CloudWatch/CloudTrail –æ–ø–µ—Ä–∞—Ü–∏–∏
- **60 –±–∞–ª–ª–æ–≤** –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫

### **CloudTrail Log Deletion (60 –±–∞–ª–ª–æ–≤)**
```python
'cloudtrail_delete_trail': 60,  # –£–¥–∞–ª–µ–Ω–∏–µ CloudTrail —Ç—Ä–µ–π–ª–æ–≤ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è –∞—É–¥–∏—Ç–∞
'cloudtrail_stop_logging': 55,  # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è CloudTrail
'cloudtrail_put_event_selectors': 50,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ª–æ–≥–æ–≤
```

**–ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
- `delete_trail()` - –ø–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–µ–π–ª–æ–≤ –∞—É–¥–∏—Ç–∞
- `stop_logging()` - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è —Ç—Ä–µ–π–ª–∞
- `put_event_selectors()` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### **CloudWatch Logs Deletion (50 –±–∞–ª–ª–æ–≤)**
```python
'cloudwatch_logs_delete_log_group': 50,  # –£–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø –ª–æ–≥–æ–≤ CloudWatch
'cloudwatch_logs_stop_logging': 45,  # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è CloudWatch Logs
'cloudwatch_logs_put_retention_policy': 40,  # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤
'cloudwatch_logs_delete_log_stream': 35,  # –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤ –ª–æ–≥–æ–≤
```

**–ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
- `delete_log_group()` - —É–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- `stop_logging()` - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è Lambda —Ñ—É–Ω–∫—Ü–∏–π
- `put_retention_policy()` - —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤ –¥–æ 1 –¥–Ω—è
- `delete_log_stream()` - —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –ª–æ–≥–æ–≤

### **Forensic Cleanup (40 –±–∞–ª–ª–æ–≤)**
```python
'secrets_manager_delete_secret': 40,  # –£–¥–∞–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏
's3_delete_bucket': 35,  # –£–¥–∞–ª–µ–Ω–∏–µ S3 –±–∞–∫–µ—Ç–æ–≤ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏
'lambda_delete_function': 35,  # –£–¥–∞–ª–µ–Ω–∏–µ Lambda —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏
```

## üéØ –ù–æ–≤—ã–µ —Ñ–ª–æ—É –∞—Ç–∞–∫

### **Log Deletion Attack**
- **–¢—Ä–µ–±—É–µ–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã:** `cloudtrail_delete_trail`, `cloudtrail_stop_logging`, `cloudwatch_logs_delete_log_group`
- **–†–æ–ª–∏:** `CloudTrailFullAccess`, `CloudWatchLogsFullAccess`
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∏ —Å–æ–∫—Ä—ã—Ç–∏–µ —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫

### **Forensic Cleanup Attack**
- **–¢—Ä–µ–±—É–µ–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã:** `secrets_manager_delete_secret`, `s3_delete_bucket`, `lambda_delete_function`
- **–†–æ–ª–∏:** `SecretsManagerFullAccess`, `S3FullAccess`, `AWSLambdaFullAccess`
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∏–µ —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫–∏ –∏ –æ—á–∏—Å—Ç–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

## üö® –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å

### **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞ (60 –±–∞–ª–ª–æ–≤):**
- **CloudTrail Delete Trail** - –ø–æ–ª–Ω–æ–µ —Å–æ–∫—Ä—ã—Ç–∏–µ –∞—É–¥–∏—Ç–∞
- –ü–æ–ª–Ω–∞—è –Ω–µ–≤–∏–¥–∏–º–æ—Å—Ç—å –¥–ª—è SOC/SIEM —Å–∏—Å—Ç–µ–º
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤

### **–í—ã—Å–æ–∫–∞—è —É–≥—Ä–æ–∑–∞ (50-55 –±–∞–ª–ª–æ–≤):**
- **CloudTrail Stop Logging** - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞—É–¥–∏—Ç–∞
- **CloudWatch Logs Delete Group** - —É–¥–∞–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–∫—Ä—ã—Ç–∏–µ —Å–ª–µ–¥–æ–≤ –∞—Ç–∞–∫

### **–°—Ä–µ–¥–Ω—è—è —É–≥—Ä–æ–∑–∞ (40-45 –±–∞–ª–ª–æ–≤):**
- **Forensic Cleanup** - —É–¥–∞–ª–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –∞—Ç–∞–∫
- **CloudWatch Logs Stop Logging** - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π
- –û—á–∏—Å—Ç–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç —Å–ª–µ–¥–æ–≤

## üî• –†–µ–∞–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∞—Ç–∞–∫

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª–Ω–æ–µ —Å–æ–∫—Ä—ã—Ç–∏–µ –∞—É–¥–∏—Ç–∞**
```bash
# 1. –£–¥–∞–ª–µ–Ω–∏–µ CloudTrail —Ç—Ä–µ–π–ª–æ–≤
aws cloudtrail delete-trail --name production-trail

# 2. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
aws cloudtrail stop-logging --name backup-trail

# 3. –£–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø –ª–æ–≥–æ–≤
aws logs delete-log-group --log-group-name /aws/lambda/monitoring-function
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π**
```bash
# –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
aws cloudtrail put-event-selectors \
    --trail-name production-trail \
    --event-selectors '[{
        "ReadWriteType": "ReadOnly",
        "IncludeManagementEvents": false,
        "DataResources": [{
            "Type": "AWS::S3::Object",
            "Values": ["arn:aws:s3:::malicious-bucket/*"]
        }]
    }]'
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è
aws logs put-retention-policy \
    --log-group-name /aws/lambda/security-monitor \
    --retention-in-days 1
```

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è

1. **–ü–æ–ª–Ω–∞—è –ø–æ—Ç–µ—Ä—è –∞—É–¥–∏—Ç–∞** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
2. **–°–æ–∫—Ä—ã—Ç–∏–µ APT –∞—Ç–∞–∫** - –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ
3. **–ù–∞—Ä—É—à–µ–Ω–∏–µ compliance** - GDPR, SOX, PCI-DSS
4. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π** - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤
5. **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∞—Ç–∞–∫–∏** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è

